(this.webpackJsonpreactfrontend=this.webpackJsonpreactfrontend||[]).push([[28],{1093:function(e,t,a){"use strict";a.r(t);var r=a(0),c=a(22),s=a(804),o=a(219),n=a(218),l=a(762),i=(a(158),a(75)),d=a(16),u=a.n(d),b=a(25),j=a(13),h=a(825),v=a(420),m=a(806),p=a(11),f=a.n(p),O=a(798),g=a(801),k=a(1);const y=Object(r.forwardRef)(((e,t)=>{let{open:a,setOpen:c,...s}=e;const o=Object(r.useMemo)((()=>j.a.getHeaders()),[]),[n,l]=Object(r.useState)(1),[i,d]=Object(r.useState)(0),[u,b]=Object(r.useState)([]),v=Object(r.useCallback)((async()=>{const e=await Object(h.d)(o,n,10);e&&(b(e.data),d(e.totalItems))}),[n,o]);return Object(r.useEffect)((()=>{v()}),[n,o,v]),Object(r.useImperativeHandle)(t,(()=>({loadArchive(){v()},length:u.length}))),Object(k.jsx)(g.a,{openArchive:a,setOpenArchive:c,loadArchive:v,archive:u,archivedData:"workOrders",headers:["Project Name","Worker","Start Date","End Date","Resource Manager","Active Date"],totalItems:i,setArchiveCurrentPage:l,archiveCurrentPage:n})}));var w=a(808),x=a(805);t.default=()=>{var e;const t=Object(i.useHistory)(),[a,d]=Object(r.useState)({}),[p,g]=Object(r.useState)([]),[D]=Object(r.useState)(j.a.getHeaders()),[S,N]=Object(r.useState)([]),[C,R]=Object(r.useState)({}),[M,Y]=Object(r.useState)(1),[A,I]=Object(r.useState)(!0),[E,F]=Object(r.useState)(10),[P,L]=Object(r.useState)(0),z=Object(r.useRef)(null),[U,W]=Object(r.useState)([]),[B,H]=Object(r.useState)(!1),[J,T]=Object(r.useState)(!1),[K,V]=Object(r.useState)([]),[_,q]=Object(r.useState)([]),[G,Q]=Object(r.useState)([]),[X,Z]=Object(r.useState)(!1),$=Object(r.useMemo)((()=>j.a.getUserInfo()),[]),[ee,te]=Object(r.useState)($.roles[0]);Object(r.useEffect)((()=>{j.a.hasAdminRole()&&H(!0)}),[]);const ae=Object(r.useCallback)((async()=>{const e="pageNo=".concat(M,"&pageSize=-1");if(Object.keys(a).length){let e="";for(const a in C)a&&(e+="&orderBy=".concat(a,"&orderMode=").concat(C[a]));const t=Object.keys(a).length?a:null;I(!0);const r=await Object(h.c)(D,M,E,e||"&orderBy=id&orderMode=desc",t);r&&I(!1),200===r.status&&(N(r.data),L(r.totalItems)),200!==r.status&&v.b.error("Something's gone wrong, refresh page or contact your system admin")}else{let t="?".concat(e);for(const e in C)e&&(t+="&orderBy=".concat(e,"&orderMode=").concat(C[e]));const a=await Object(h.e)(D,t);a&&I(!1),200===a.statusCode&&(N(a.tableData),L(a.totalItems)),200!==a.statusCode&&v.b.error("Something's gone wrong, refresh page or contact your system admin")}}),[a,M,E,D,C]);Object(r.useEffect)((()=>{ae()}),[ae,null===z||void 0===z||null===(e=z.current)||void 0===e?void 0:e.length]);const re=Object(r.useCallback)((e=>d({...a,search:e})),[a]),ce=Object(r.useCallback)((e=>{let t=[];for(let a in e)if("string"!==typeof e[a]&&"number"!==typeof e[a]||"id"===a||""===e[a])"object"===typeof e[a]&&(t=t.concat(ce(e[a])));else if("projectName"===a){let r=e[a].split(", ");t.push(r[0],r[1],r[2])}else t.push(e[a]);return t}),[]);Object(r.useEffect)((()=>{if(S){let e=[];for(let t of S){ce(t).forEach((t=>{e.includes(t)||e.push(t)}))}V(e)}}),[S,ce]);const se=Object(r.useCallback)((e=>{t.push("/workOrders/".concat(e))}),[t]),oe={onChange:e=>{B||ee.workOrderPermission?W(e):W([])},selectedRowKeys:U};Object(r.useEffect)((()=>{ae()}),[ae]);const ne=Object(r.useCallback)((async()=>{await u.a.get("".concat(b.a.serverURL,"/worker?dropdownFilter=true"),{headers:D}).then((e=>{e.data&&q(e.data.map((e=>({text:"".concat(e.firstName," (").concat(e.lastName,")"),value:e.id}))))})).catch((e=>console.log(e)))}),[D]);Object(r.useEffect)((()=>ne()),[ne]);const le=Object(r.useCallback)((async()=>{await u.a.get("".concat(b.a.serverURL,"/projects?dropdownFilter=true"),{headers:D}).then((e=>{e.data&&Q(e.data.map((e=>({text:"".concat(e.projectName," "),value:e.id}))))})).catch((e=>console.log(e)))}),[D]);Object(r.useEffect)((()=>le()),[le]);const ie=Object(r.useMemo)((()=>[{title:"Project",dataIndex:"project",key:"project.projectName",filters:G,sorter:!0,fixed:"left",width:170,render:(e,t)=>Object(k.jsx)(O.a,{label:"".concat(e.projectName," "),onClick:()=>se(t.id)})},{title:"WorkerName",dataIndex:"worker",key:"worker.firstName",filters:_,sorter:!0,fixed:"left",width:170,render:(e,t)=>Object(k.jsx)(O.a,{label:"".concat(null===e||void 0===e?void 0:e.firstName," ").concat(null===e||void 0===e?void 0:e.lastName),onClick:()=>se(t.id)})},{title:"Start Date",dataIndex:"startDate",key:"startDate",sorter:!0,render:e=>f()(e).format("MM/DD/YYYY")},{title:"End Date",dataIndex:"endDate",key:"endDate",sorter:!0,render:e=>f()(e).format("MM/DD/YYYY")},{title:"Resource Manager",dataIndex:"project",key:"project.resourceManager.firstName",width:120,sorter:!0,render:e=>{var t,a;return Object(k.jsx)(m.a,{name:"".concat(null===e||void 0===e||null===(t=e.resourceManager)||void 0===t?void 0:t.firstName," ").concat(null===e||void 0===e||null===(a=e.resourceManager)||void 0===a?void 0:a.lastName)})}},{title:"Active Date",dataIndex:"activeDate",sorter:!0,key:"activeDate"},{title:"Status",dataIndex:"status",sorter:!0,key:"status"},{title:"Rebate Adjusted Bill Rate/hr",dataIndex:"billRate",key:"billRate",render:e=>Object(k.jsx)("div",{style:{textAlign:"right",marginLeft:"10px"},children:Number(e).toFixed(2)})},{title:"C2C Pay Rate/hr",dataIndex:"payRate",key:"payRate",render:e=>Object(k.jsx)("div",{style:{textAlign:"right",marginLeft:"10px"},children:Number(e).toFixed(2)})},{title:"Margin/hr",dataIndex:"margin",key:"margin",render:e=>Object(k.jsx)("div",{style:{textAlign:"right",marginLeft:"10px"},children:Number(e).toFixed(2)})}]),[se,_,G]);return Object(r.useEffect)((()=>{g(ie)}),[ie]),Object(k.jsxs)(o.a,{children:[Object(k.jsx)(n.a,{title:"WorkOrder",actions:B||ee.workOrderPermission?Object(k.jsxs)(c.a,{type:"button",className:"btn main margin-left",handleClick:()=>{t.push("/addworkOrder")},children:[Object(k.jsx)(l.a,{className:"icon"}),"Add WorkOrder"]}):""}),Object(k.jsx)(s.a,{columns:p,setColumns:g,defaultColumns:ie,filters:a,rowSelection:!(!B&&!ee.workOrderPermission)&&oe,total:P,setSort:R,loading:A,searchOptions:K,searchList:S,handleSearch:re,setPageSize:F,setCurrentPage:Y,setFilters:d,openArchive:()=>T(!0),openReports:()=>Z(!0),handleConfirmArchive:async()=>{200===await Object(h.a)(D,U)?(ae(),v.b.success("Workorder record archived successfully!"),z.current.loadArchive(),W([])):v.b.error("Something's gone wrong, refresh page or contact your system admin")},handleCancelArchiving:()=>{W([])},data:S.map((e=>({...e,key:e.id}))),removeableColumns:ie.filter((e=>"Project"!==e.title&&e.title)).map((e=>e.title))}),Object(k.jsx)(x.a,{showReportModal:X,setShowReportModal:Z,individualReportName:"workOrders",individualList:S,list:S.map((e=>({id:e.id,name:"".concat(e.project.projectName)}))),listLabel:"workOrder",filename:"workOrder_report",tableFields:[{label:"Worker",value:"worker",key:"worker"},{label:"Start Date",value:"startDate",key:"startDate"},{label:"End Date",value:"endDate",key:"endDate"},{label:"Resource Manager",value:"resourceManager",key:"resourceManager"},{label:"Active Date",value:"activeDate",key:"activeDate"},{label:"Status",value:"status",key:"status"},{label:"Rebate Adjusted Bill Rate/hr ",value:"payRate",key:"payRate"},{label:"C2C Pay Rate/hr",value:"billRate",key:"billRate"},{label:"Margin/hr ",value:"margin",key:"margin"}],pdfFormatter:w.a.workOrderPdfFormat,csvExcelFormatter:w.a.workOrderCSVExcel}),Object(k.jsx)(y,{open:J,setOpen:T,ref:z})]})}},798:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));a(800);var r=a(1);const c=e=>Object(r.jsxs)("div",{className:"tablelink-container",children:[Object(r.jsx)("span",{onClick:e.onClick,className:"tablelink ".concat(e.styleRed&&"red"," ").concat(e.className&&e.className),children:e.label}),e.extra&&Object(r.jsx)("span",{className:"table-link-extra",children:e.extra})]})},806:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));a(807);var r=a(1);const c=e=>{let{name:t,location:a,...c}=e;return Object(r.jsxs)("div",{className:"client-details-container",children:[Object(r.jsx)("span",{children:t}),Object(r.jsx)("span",{children:a}),c.extra&&Object(r.jsx)("span",{children:c.extra})]})}},807:function(e,t,a){},825:function(e,t,a){"use strict";a.d(t,"e",(function(){return b})),a.d(t,"b",(function(){return h})),a.d(t,"c",(function(){return v})),a.d(t,"f",(function(){return m})),a.d(t,"d",(function(){return p})),a.d(t,"a",(function(){return f}));var r=a(25),c=a(13),s=a(16),o=a.n(s),n=a(11),l=a.n(n);const i="".concat(r.a.serverURL,"/workOrders"),d=e=>{var t,a;if(!e.response)throw new Error;return 401===(null===(t=e.response)||void 0===t?void 0:t.status)&&c.a.logout(),{status:null===(a=e.response)||void 0===a?void 0:a.status,err:e}},u=e=>e.map((e=>({...e}))),b=async function(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const a="".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"").concat(t);return await j(e,a)},j=async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{const r=await o.a.get("".concat(i).concat(t).concat(a),{headers:e});let c={};return 200===r.status&&(c.tableData=u(r.data),c.totalItems=r.headers["total-elements"],c.statusCode=r.status),c}catch(s){var r;return 401===s.response.status&&c.a.logout(),{statusCode:null===(r=s.response)||void 0===r?void 0:r.status}}},h=async(e,t)=>{try{const a=await o.a.get("".concat(r.a.serverURL,"/workOrders/").concat(t),{headers:e});let c={};return 200===a.status&&(c.workOrderData=a.data,c.Details=a.data,c.statusCode=a.status),c}catch(c){var a;return console.log(c),{statusCode:null===(a=c.response)||void 0===a?void 0:a.status}}},v=async(e,t,a,r,c)=>{try{const s=r||c?r?"?dropdownFilter=true&pageNo=".concat(t-1,"&pageSize=").concat(a,"&").concat(r):"?dropdownFilter=true&pageNo=".concat(t-1,"&pageSize=").concat(a):"?pageNo=".concat(t-1,"&pageSize=-1"),n=c?await o.a.put("".concat(i).concat(s),c,{headers:e}):await o.a.get("".concat(i).concat(s),{headers:e});if(200===n.status)return{data:n.data,totalItems:n.headers["total-elements"],status:n.status}}catch(s){return d(s)}},m=async(e,t,a)=>{try{const c=await o.a.patch("".concat(r.a.serverURL,"/workOrders/").concat(a),t,{headers:e});if(200===c.status)return{statusCode:200,data:c.data};if(401===c.status)return{statusCode:c.status}}catch(n){var s;return 401===n.response.status&&c.a.logout(),{statusCode:null===(s=n.response)||void 0===s?void 0:s.status}}},p=async(e,t,a)=>{try{const r=await o.a.get("".concat(i,"?archives=true&pageNo=").concat(t-1,"&pageSize=").concat(a),{headers:e});if(r)return{data:r.data.map((e=>{var t,a,r,c,s;return{id:e.id,cellOne:null===(t=e.project)||void 0===t?void 0:t.projectName,cellTwo:"".concat(null===(a=e.worker)||void 0===a?void 0:a.firstName," ").concat(null===(r=e.worker)||void 0===r?void 0:r.lastName),cellThree:e.startDate?l()(e.startDate).format("MM/DD/YYYY"):"",cellFour:e.endDate?l()(e.endDate).format("MM/DD/YYYY"):"",cellFive:"".concat(null===(c=e.project.resourceManager)||void 0===c?void 0:c.firstName," ").concat(null===(s=e.project.resourceManager)||void 0===s?void 0:s.lastName),cellSix:e.activeDate?l()(e.activeDate).format("MM/DD/YYYY"):""}})),totalItems:r.headers["total-elements"]}}catch(r){console.log(r)}},f=async(e,t)=>{try{const a=await o.a.all(t.map((t=>o.a.delete("".concat(i,"/").concat(t),{headers:e}))));if(a.length)return a[0].status}catch(a){return d(a)}}}}]);