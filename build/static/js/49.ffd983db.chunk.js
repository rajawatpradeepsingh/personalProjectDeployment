(this.webpackJsonpreactfrontend=this.webpackJsonpreactfrontend||[]).push([[49],{1094:function(e,t,a){"use strict";a.r(t);var s=a(0),c=a(22),n=a(804),o=a(219),r=a(218),l=a(762),i=(a(158),a(75)),d=a(11),u=a.n(d),m=a(16),h=a.n(m),b=a(25),p=a(13),j=a(28),v=a(420),O=a(826),f=a(801),g=a(1);const y=Object(s.forwardRef)(((e,t)=>{let{open:a,setOpen:c,...n}=e;const o=Object(s.useMemo)((()=>p.a.getHeaders()),[]),[r,l]=Object(s.useState)(1),[i,d]=Object(s.useState)(0),[u,m]=Object(s.useState)([]),h=Object(s.useCallback)((async()=>{const e=await Object(O.e)(o,r,10);e&&(m(e.data),d(e.totalItems))}),[r,o]);return Object(s.useEffect)((()=>{h()}),[r,o,h]),Object(s.useImperativeHandle)(t,(()=>({loadArchive(){h()},length:u.length}))),Object(g.jsx)(f.a,{openArchive:a,setOpenArchive:c,loadArchive:h,archive:u,archivedData:"timesheet",headers:["Worker","project","TimeSheet Status","Updated On","Timesheet End date","Bill Able Hours","Comments"],totalItems:i,setArchiveCurrentPage:l,archiveCurrentPage:r})}));var S=a(798),k=a(805),w=a(808);var C=a(54);t.default=()=>{var e;const t=Object(s.useMemo)((()=>p.a.getHeaders()),[]),a=Object(i.useHistory)(),[d,m]=Object(s.useState)({}),[f,x]=Object(s.useState)([]),[N,D]=Object(s.useState)([]),[I,A]=Object(s.useState)({}),[M,E]=(Object(j.b)(),Object(s.useState)(1)),[R,T]=Object(s.useState)(!0),[Y,F]=Object(s.useState)(10),[H,L]=Object(s.useState)(0),P=Object(s.useRef)(null),[U,z]=Object(s.useState)(!1),[B,W]=Object(s.useState)(!1),[J,K]=Object(s.useState)([]),[V,_]=Object(s.useState)([]),q=Object(s.useMemo)((()=>p.a.getUserInfo()),[]),[G,Q]=Object(s.useState)(q.roles[0]),[X,Z]=Object(s.useState)(!1),[$,ee]=Object(s.useState)([]),[te,ae]=Object(s.useState)([]),[se,ce]=Object(s.useState)([]);Object(s.useEffect)((()=>{p.a.hasAdminRole()&&W(!0)}),[]);const ne={onChange:(e,t)=>{B||G.timesheetPermission?K(e):K([])},selectedRowKeys:J},oe=Object(s.useCallback)((e=>{a.push("/timesheet/".concat(e))}),[a]),re=Object(s.useCallback)((e=>{m({...d,search:e})}),[d]),le=Object(s.useCallback)((e=>{let t=[];for(let a in e)"string"!==typeof e[a]&&"number"!==typeof e[a]||"id"===a||""===e[a]?"object"===typeof e[a]&&(t=t.concat(le(e[a]))):t.push(e[a]);return t}),[]),ie=Object(s.useCallback)((async()=>{await h.a.get("".concat(b.a.serverURL,"/worker?dropdownFilter=true"),{headers:t}).then((e=>{e.data&&ee(e.data.map((e=>({text:"".concat(e.firstName," (").concat(e.lastName,")"),value:e.id}))))})).catch((e=>console.log(e)))}),[t]);Object(s.useEffect)((()=>ie()),[ie]);const de=Object(s.useCallback)((async()=>{await h.a.get("".concat(b.a.serverURL,"/clients?dropdownFilter=true"),{headers:t}).then((e=>{e.data&&ae(e.data.map((e=>({text:"".concat(e.clientName," "),value:e.clientName}))))})).catch((e=>console.log(e)))}),[t]);Object(s.useEffect)((()=>de()),[de]),Object(s.useEffect)((()=>{if(N){let e=[];for(let t of N){le(t).forEach((t=>{e.includes(t)||e.push(t)}))}_(e)}}),[N,d,le]),console.log(N);const ue=Object(s.useMemo)((()=>[{title:"WorkerName",dataIndex:"worker",key:"worker.firstName",filters:$,sorter:!0,fixed:"left",width:170,render:(e,t)=>Object(g.jsx)(S.a,{label:"".concat(null===e||void 0===e?void 0:e.firstName," ").concat(null===e||void 0===e?void 0:e.lastName),onClick:()=>oe(t.id)})},{title:"Client",key:"clientId",dataIndex:"clientId",width:120,sorter:!0,filters:te},{title:"Status",dataIndex:"timeSheetStatus",sorter:!0,key:"timeSheetStatus",width:160,ellipsis:!0,filters:C.s.map((e=>({text:e,value:e})))},{title:"Updated On",dataIndex:"updatedOn",key:"updatedOn",render:e=>e?u()(e).format("MM/DD/YYYY"):""},{title:"Billable Hours",render:(e,t)=>Object(g.jsx)("span",{style:{paddingLeft:"100px"},children:"".concat((null===e||void 0===e?void 0:e.billableHours)||"")})},{title:"Timesheet EndDate",render:(e,t)=>{var a;return Object(g.jsx)("span",{children:"".concat((null===e||void 0===e||null===(a=e.timesheetWeekDays)||void 0===a?void 0:a.sundayDate)||"")})}},{title:"Timesheet Attachment",render:(e,t)=>{var a;return Object(g.jsx)("span",{children:"".concat((null===e||void 0===e||null===(a=e.resume)||void 0===a?void 0:a.resumeName)||"")})}},{title:"Comment",dataIndex:"comments",key:"comments"}]),[$,te]);Object(s.useEffect)((()=>{x(ue)}),[ue]);const me=Object(s.useCallback)((async()=>{const e="pageNo=".concat(M,"&pageSize=-1");if(Object.keys(d).length){let e="";for(const t in I)t&&(e+="&orderBy=".concat(t,"&orderMode=").concat(I[t]));const a=Object.keys(d).length?d:null;T(!0);const s=await Object(O.b)(t,M,Y,e||"&orderBy=id&orderMode=desc",a);s&&T(!1),200===s.status&&(D(s.data),L(s.totalItems)),200!==s.status&&v.b.error("Something's gone wrong, refresh page or contact your system admin")}else{let a="?".concat(e);for(const e in I)e&&(a+="&orderBy=".concat(e,"&orderMode=").concat(I[e]));const s=await Object(O.d)(t,a);s&&T(!1),200===s.statusCode&&(D(s.tableData),L(s.totalItems)),200!==s.statusCode&&v.b.error("Something's gone wrong, refresh page or contact your system admin")}}),[t,M,Y,I,d]);Object(s.useEffect)((()=>{me()}),[me,d,null===P||void 0===P||null===(e=P.current)||void 0===e?void 0:e.length]);return Object(s.useEffect)((()=>{me()}),[me]),Object(g.jsxs)(o.a,{children:[Object(g.jsx)(r.a,{title:"TimeSheet",actions:B||G.timesheetPermission?Object(g.jsxs)(c.a,{type:"button",className:"btn main margin-left",handleClick:()=>{a.push("/addtimesheet")},children:[Object(g.jsx)(l.a,{className:"icon"}),"Add TimeSheet"]}):""}),Object(g.jsx)(n.a,{openReports:()=>Z(!0),loading:R,columns:f,setColumns:x,defaultColumns:ue,filters:d,rowSelection:!(!B&&!G.timesheetPermission)&&ne,total:H,setSort:A,setPageSize:F,setCurrentPage:E,setFilters:m,searchOptions:V,searchList:N,handleSearch:re,openArchive:()=>z(!0),handleConfirmArchive:async()=>{200===await Object(O.a)(t,J)?(me(),v.b.success("Timesheet record archived successfully!"),P.current.loadArchive(),K([])):v.b.error("Something's gone wrong, refresh page or contact your system admin")},handleCancelArchiving:()=>{K([])},data:N.map((e=>({...e,key:e.id}))),removeableColumns:ue.filter((e=>"TimeSheet"!==e.title&&e.title)).map((e=>e.title))}),Object(g.jsx)(k.a,{showReportModal:X,setShowReportModal:Z,individualReportName:"timesheet",individualList:N,list:N.map((e=>({id:e.id,name:"".concat(e.worker.firstName+" "+e.worker.lastName)}))),listLabel:"TimeSheet",filename:"timesheet_report",tableFields:[{label:"Client",value:"client",key:"client"},{label:"Timesheet Status",value:"timeSheetStatus",key:"timeSheetStatus"},{label:"Updated On",value:"updatedOn",key:"updatedOn"},{label:"Bill Able Hours",value:"billableHours",key:"billableHours"},{label:"Timesheet Weekdays",value:"timesheetWeekDays",key:"timesheetWeekDays"},{label:"Attachment",value:"resume",key:"resume"},{label:"Comments",value:"comments",key:"comments"}],pdfFormatter:w.a.timesheetPdfFormat,csvExcelFormatter:w.a.timesheetCSVExcel}),Object(g.jsx)(y,{open:U,setOpen:z,ref:P})]})}},798:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));a(800);var s=a(1);const c=e=>Object(s.jsxs)("div",{className:"tablelink-container",children:[Object(s.jsx)("span",{onClick:e.onClick,className:"tablelink ".concat(e.styleRed&&"red"," ").concat(e.className&&e.className),children:e.label}),e.extra&&Object(s.jsx)("span",{className:"table-link-extra",children:e.extra})]})},826:function(e,t,a){"use strict";a.d(t,"d",(function(){return m})),a.d(t,"b",(function(){return b})),a.d(t,"e",(function(){return p})),a.d(t,"a",(function(){return j})),a.d(t,"c",(function(){return v})),a.d(t,"f",(function(){return O}));var s=a(25),c=a(13),n=a(16),o=a.n(n),r=a(11),l=a.n(r);const i="".concat(s.a.serverURL,"/timesheet"),d=e=>{var t,a;if(!e.response)throw new Error;return 401===(null===(t=e.response)||void 0===t?void 0:t.status)&&c.a.logout(),{status:null===(a=e.response)||void 0===a?void 0:a.status,err:e}},u=e=>e.map((e=>({...e}))),m=async function(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const a="".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"").concat(t);return await h(e,a)},h=async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{const s=await o.a.get("".concat(i).concat(t).concat(a),{headers:e});let c={};return 200===s.status&&(c.tableData=u(s.data),c.totalItems=s.headers["total-elements"],c.statusCode=s.status),c}catch(n){var s;return 401===n.response.status&&c.a.logout(),{statusCode:null===(s=n.response)||void 0===s?void 0:s.status}}},b=async(e,t,a,s,c)=>{try{const n=s||c?s?"?dropdownFilter=true&pageNo=".concat(t-1,"&pageSize=").concat(a,"&").concat(s):"?dropdownFilter=true&pageNo=".concat(t-1,"&pageSize=").concat(a):"?pageNo=".concat(t-1,"&pageSize=-1"),r=c?await o.a.put("".concat(i).concat(n),c,{headers:e}):await o.a.get("".concat(i).concat(n),{headers:e});if(200===r.status)return{data:r.data.length?u(r.data):[],totalItems:r.headers["total-elements"],status:r.status}}catch(n){return d(n)}},p=async(e,t,a)=>{try{const s=await o.a.get("".concat(i,"?archives=true&pageNo=").concat(t-1,"&pageSize=").concat(a),{headers:e});if(s)return{data:s.data.map((e=>{var t,a,s,c;return{id:e.id,cellOne:"".concat(null===(t=e.worker)||void 0===t?void 0:t.firstName," ").concat(null===(a=e.worker)||void 0===a?void 0:a.lastName),cellTwo:null===e||void 0===e||null===(s=e.workOrder)||void 0===s||null===(c=s.project)||void 0===c?void 0:c.projectName,cellThree:null===e||void 0===e?void 0:e.timeSheetStatus,cellFour:e.updatedOn?l()(e.updatedOn).format("MM/DD/YYYY"):"",cellFive:e.statusChangedOn?l()(e.statusChangedOn).format("MM/DD/YYYY"):"",cellSix:e.billableHours||"",cellSeven:e.comments||""}})),totalItems:s.headers["total-elements"]}}catch(s){console.log(s)}},j=async(e,t)=>{try{const a=await o.a.all(t.map((t=>o.a.delete("".concat(i,"/").concat(t),{headers:e}))));if(a.length)return a[0].status}catch(a){return d(a)}},v=async(e,t)=>{try{const a=await o.a.get("".concat(s.a.serverURL,"/timesheet/").concat(t),{headers:e});let c={};return 200===a.status&&(c.timeSheetData=a.data,c.Details=a.data,c.statusCode=a.status),c}catch(c){var a;return console.log(c),{statusCode:null===(a=c.response)||void 0===a?void 0:a.status}}},O=async(e,t,a)=>{try{const s=await o.a.put("".concat(i,"/update/").concat(a),t,{headers:e});if(200===s.status)return{statusCode:200,data:s.data};if(401===s.status)return{statusCode:401}}catch(s){return console.log(s),{statusCode:s.response.status}}}}}]);