(this.webpackJsonpreactfrontend=this.webpackJsonpreactfrontend||[]).push([[48],{1087:function(e,t,a){"use strict";a.r(t),a.d(t,"ViewCommissionType",(function(){return w}));var s=a(219),c=a(218),n=a(22),o=a(762),r=a(75),i=a(844),l=a(0),u=a(13),d=a(798),m=a(16),b=a.n(m),p=a(420),j=a(25),h=a(28),O=a(91),v=a(152),y=a(804),g=a(801),f=a(1);const C=e=>{let{open:t,setOpen:a,...s}=e;const c=Object(l.useMemo)((()=>u.a.getHeaders()),[]),[n,o]=Object(l.useState)(1),[r,d]=Object(l.useState)(0),[m,b]=Object(l.useState)([]),p=Object(l.useCallback)((async()=>{const e=await Object(i.a)(c,n,10);e&&(b(e.tableData),d(e.totalItems))}),[n,c]);return Object(l.useEffect)((()=>{p()}),[n,c,p,t]),Object(f.jsx)(g.a,{openArchive:t,setOpenArchive:a,loadArchive:p,archive:m,archivedData:"commissionType",headers:["Commision Type","Commission Rate","Margin Bracket ($)"],totalItems:r,setArchiveCurrentPage:o,archiveCurrentPage:n})};var x=a(306),k=a(805),S=a(808);const w=()=>{const[e,t]=Object(l.useState)(!1),a=Object(r.useHistory)(),[m,g]=Object(l.useState)([]),w=Object(l.useMemo)((()=>u.a.getHeaders()),[]),[T,R]=Object(l.useState)([]),[M,I]=Object(l.useState)([]),[N,A]=Object(l.useState)(1),[D,E]=Object(l.useState)(10),[F,L]=Object(l.useState)(0),[B,P]=Object(l.useState)({}),[z,H]=Object(l.useState)(!1),[$,J]=Object(l.useState)(!1),[U,V]=Object(l.useState)({}),[K,_]=Object(l.useState)([]),[q,G]=Object(l.useState)(!1),[Q,W]=Object(l.useState)(!0),[X,Y]=Object(l.useState)(!1),Z=Object(h.b)(),ee=Object(l.useCallback)((()=>{Z(Object(O.b)(!1)),u.a.logout()}),[Z]),te=Object(l.useCallback)((e=>{a.push("/commissionType/".concat(e))}),[a]),ae=Object(l.useMemo)((()=>[{title:"Commision Type",dataIndex:"name",key:"name",fixed:"left",width:170,render:(e,t)=>Object(f.jsx)(d.a,{onClick:()=>te(t.id),label:e})},{title:"Commission Rate",dataIndex:"commRate",key:"commRate",align:"center",sorter:!0,render:(e,t)=>Object(f.jsx)("div",{style:{textAlign:"right"},children:Object(f.jsx)("span",{children:e})})},{title:"Margin Bracket ($)",dataIndex:"commMargin",key:"commMargin",align:"center",sorter:!0,render:(e,t)=>Object(f.jsx)("div",{style:{textAlign:"right"},children:Object(f.jsx)("span",{children:e})})}]),[]);Object(l.useEffect)((()=>{R(ae)}),[ae]);const se=Object(l.useCallback)((async()=>{const e="pageNo=".concat(N-1,"&pageSize=-1");if(!Object.keys(B).length){let t="?".concat(e);for(const e in U)e&&(t+="&orderBy=".concat(e,"&orderMode=").concat(U[e]));return await i.c(w,t)}{const e=Object.keys(U)[0]?Object.keys(U)[0]:"",a=e?U[e]:"",s=await i.d(w,N,D,B,e||"id",a||"desc");200===s.statusCode&&(g(s.data),L(s.totalItems),t(!1))}}),[w,N,D,U,B]);Object(l.useEffect)((()=>{let e=!1;return t(!0),se().then((e=>{200===e.statusCode&&(g(e.tableData),L(e.totalItems))})).catch((t=>{e||console.log(t)})).finally((()=>t(!1))),()=>e=!0}),[se,z]);const ce=Object(l.useCallback)((e=>{P({...B,search:e})}),[B]),ne=Object(l.useCallback)((e=>{let t=[];for(let a in e)"string"!==typeof e[a]&&"number"!==typeof e[a]||"id"===a||""===e[a]?"object"===typeof e[a]&&(t=t.concat(ne(e[a]))):t.push(e[a]);return t}),[]);Object(l.useEffect)((()=>{if(m){let e=[];for(let t of m){ne(t).forEach((t=>{e.includes(t)||e.push(t)}))}_(e)}}),[m,B,ne]);const oe={onChange:(e,t)=>{I(q?[]:e)},selectedRowKeys:M};return Object(f.jsxs)(s.a,{children:[Object(f.jsx)(v.a,{onActive:()=>{W(!0)},onIdle:()=>{W(!1)},onLogout:()=>{Y(!0)}}),Object(f.jsx)(c.a,{breadcrumbs:Object(f.jsx)(x.a,{className:"header",crumbs:[{id:0,text:"Commission",onClick:()=>{a.push("/viewcommission")}},{id:1,text:"Commission Type",lastCrumb:!0}]}),actions:Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)(n.a,{type:"button",className:"btn main margin-left",handleClick:()=>{return e="/addcommissiontype",void a.push(e);var e},children:[Object(f.jsx)(o.a,{className:"icon"}),"Add Commission Type"]})})}),Object(f.jsx)(y.a,{loading:e,data:m.map((e=>({...e,key:e.id}))),columns:T,setColumns:R,defaultColumns:ae,rowSelection:q?null:oe,total:F,setCurrentPage:A,setPageSize:E,setSort:V,setFilters:P,filters:B,searchOptions:K,searchList:m,handleSearch:ce,openArchive:()=>H(!0),openReports:()=>J(!0),handleConfirmArchive:async()=>{try{if(await b.a.all(M.map((e=>b.a.delete("".concat(j.a.serverURL,"/commissionType/").concat(e),{headers:w}))))){const e=await se();e&&(g(e.tableData),L(e.totalItems),p.b.success("commission Type archived successfully!"),I([]))}}catch(t){var e;p.b.error("Error ".concat(null===(e=t.response)||void 0===e?void 0:e.status)),t.response&&401===t.response.status&&ee()}},handleCancelArchiving:()=>{I([])},removeableColumns:ae.filter((e=>"Commision Type"!==e.title&&e.title)).map((e=>e.title))}),Object(f.jsx)(C,{open:z,setOpen:H}),Object(f.jsx)(k.a,{showReportModal:$,setShowReportModal:J,individualReportName:"commissionType",individualList:m,list:m.map((e=>({id:e.id,name:e.name}))),listLabel:"commissionType",filename:"commissionType_report",tableFields:[{label:"Commission Rate",value:"commRate",key:"commRate"},{label:"Margin Bracket ($)",value:"commMargin",key:"commMargin"}],pdfFormatter:S.a.commissionTypePdfFormat,csvExcelFormatter:S.a.commissionTypeCSVExcel})]})};t.default=w},798:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));a(800);var s=a(1);const c=e=>Object(s.jsxs)("div",{className:"tablelink-container",children:[Object(s.jsx)("span",{onClick:e.onClick,className:"tablelink ".concat(e.styleRed&&"red"," ").concat(e.className&&e.className),children:e.label}),e.extra&&Object(s.jsx)("span",{className:"table-link-extra",children:e.extra})]})},844:function(e,t,a){"use strict";a.d(t,"b",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"d",(function(){return m})),a.d(t,"e",(function(){return b})),a.d(t,"a",(function(){return p}));var s=a(16),c=a.n(s),n=a(25),o=a(13);const r="".concat(n.a.serverURL,"/commissionType"),i=e=>e.map((e=>({...e}))),l=async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{const s=await c.a.get("".concat(r).concat(t).concat(a),{headers:e});let n={};return 200===s.status&&(n.tableData=i(s.data),n.totalItems=s.headers["total-elements"],n.statusCode=s.status),n}catch(n){var s;return 401===n.response.status&&o.a.logout(),{statusCode:null===(s=n.response)||void 0===s?void 0:s.status}}},u=async(e,t)=>{try{const a=await c.a.get("".concat(r,"/").concat(t),{headers:e});let s={};return 200===a.status&&(s.commTypeData=a.data,s.statusCode=a.status),s}catch(n){var a,s;return 401===(null===(a=n.response)||void 0===a?void 0:a.status)&&o.a.logout(),{statusCode:null===(s=n.response)||void 0===s?void 0:s.status}}},d=async function(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const a="".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"").concat(t);return await l(e,a)},m=async(e,t,a,s,n,l)=>{const u=n?"&orderBy=".concat(n,"&orderMode=").concat(l):"",d="pageNo=".concat(t-1,"&pageSize=").concat(a);let m="".concat(r,"?dropdownFilter=true&").concat(d);Object.keys(u).length&&(m+="".concat(u));try{const t=await c.a.put(m,s,{headers:e});if(t)return{statusCode:t.status,data:t.data.length?i(t.data):[],totalItems:t.headers["total-elements"]}}catch(j){var b,p;return console.log(j),401===(null===(b=j.response)||void 0===b?void 0:b.status)&&o.a.logout(),{statusCode:null===(p=j.response)||void 0===p?void 0:p.status}}},b=async(e,t,a)=>{try{const s=await c.a.put("".concat(r,"/").concat(a),t,{headers:e});if(200===s.status)return{statusCode:200,data:s.data};if(401===s.status)return{statusCode:s.status}}catch(n){var s;return 401===n.response.status&&o.a.logout(),{statusCode:null===(s=n.response)||void 0===s?void 0:s.status}}},p=async(e,t,a)=>{try{const s=await c.a.get("".concat(r,"?archives=true&pageNo=").concat(t-1,"&pageSize=").concat(a),{headers:e});return 200===s.status?{tableData:s.data.map((e=>({id:e.id,cellOne:e.name,cellTwo:e.commRate||"n/a",cellThree:e.commMargin||"n/a"}))),totalItems:s.headers["total-elements"]}:{tableData:[],totalItems:0}}catch(n){var s;return 401===n.response.status&&o.a.logout(),{statusCode:null===(s=n.response)||void 0===s?void 0:s.status}}}}}]);