(this.webpackJsonpreactfrontend=this.webpackJsonpreactfrontend||[]).push([[64],{1095:function(e,t,a){"use strict";a.r(t);var s=a(137),l=a(66),n=a(0),o=a(306),i=a(22),d=a(307),c=a(309),r=a(13),u=a(75),m=a(28),b=a(25),v=a(50),j=a(16),h=a.n(j),O=a(91),p=a(96),x=a(333),f=a(35),g=a(317),y=a(95),D=a(27),k=a(11),S=a.n(k),C=a(1);var w=()=>{var e,t,a,s,l,o,i,d,c,u,v,j,O,p,k,w,N,W,H,M,E,T,L;const{editEnabled:I}=Object(m.c)((e=>e.timesheet)),{timeSheetDetails:R}=Object(m.c)((e=>e.timesheet)),Y=e=>F(Object(x.e)(e)),F=Object(m.b)(),[P,z]=Object(n.useState)([]),[A]=Object(n.useState)(r.a.getHeaders()),{inputErr:U,requiredErr:q}=Object(m.c)((e=>e.timesheet)),B=e=>F(Object(g.d)(e));Object(n.useEffect)((()=>{(()=>{if(r.a.hasAdminRole()||r.a.hasRecruiterRole()){let e=JSON.parse(sessionStorage.getItem("headers"));h.a.get(b.a.serverURL+"/worker?dropdownFilter=true",{headers:e}).then((e=>{const t=e.data;e.data&&z(t)})).catch((e=>{console.log(e),e.response&&401===e.response.status&&r.a.logout()}))}})()}),[]);const V=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;var a;a=!0,F(Object(g.b)(a));const s=Object(y.a)(t,e.target.value);let l;""!==e.target.value&&(l={...q},delete l[e.target.name],(e=>{F(Object(g.f)(e))})(l)),Y({...R,[e.target.name]:e.target.value}),s?(l={...U},delete l[e.target.name],B(l)):B({...U,[e.target.name]:"Invalid format or characters"})};return I?Object(C.jsxs)(n.Fragment,{children:[Object(C.jsx)("h3",{className:"disabled-form-section-header",children:"Basic Information"}),Object(C.jsx)(f.a,{label:"Worker Name",name:"workerId","data-testid":"worker-options",value:(null===R||void 0===R||null===(O=R.worker)||void 0===O?void 0:O.id)||"",required:!0,onChange:e=>{let t=P.filter((t=>+t.id===+e.target.value))[0];Y({...R,worker:{id:t.id}})},options:P.map((e=>({id:e.id,name:"".concat(e.firstName," ").concat(e.lastName)}))),disabled:!0}),Object(C.jsxs)("span",{style:{display:"flex",flexDirection:"column",paddingBottom:"18px"},children:[Object(C.jsx)("span",{style:{fontWeight:"600",fontSize:"12px",textTransform:"uppercase",color:"black"},children:"Time Period:"}),Object(C.jsx)("span",{style:{fontWeight:"200",fontSize:"13px",maxHeight:"100px",overflowY:"auto"},children:(null===R||void 0===R||null===(p=R.timesheetWeekDays)||void 0===p?void 0:p.mondayDate)+" to "+(null===R||void 0===R||null===(k=R.timesheetWeekDays)||void 0===k?void 0:k.sundayDate)})]}),Object(C.jsxs)("span",{style:{display:"flex",flexDirection:"column",paddingBottom:"18px"},children:[Object(C.jsx)("span",{style:{fontWeight:"600",fontSize:"12px",textTransform:"uppercase",color:"black"},children:"Work Order:"}),Object(C.jsx)("span",{style:{fontWeight:"200",fontSize:"13px",maxHeight:"100px",overflowY:"auto"},children:"".concat(null===R||void 0===R||null===(w=R.workOrder)||void 0===w?void 0:w.id," PRJ-").concat(null===R||void 0===R||null===(N=R.workOrder)||void 0===N||null===(W=N.project)||void 0===W||null===(H=W.client)||void 0===H?void 0:H.clientName.slice(0,3),"-000").concat(null===R||void 0===R||null===(M=R.workOrder)||void 0===M?void 0:M.id,"  ")})]}),Object(C.jsxs)("span",{style:{display:"flex",flexDirection:"column",paddingBottom:"18px"},children:[Object(C.jsx)("span",{style:{fontWeight:"600",fontSize:"12px",textTransform:"uppercase",color:"black"},children:"Client:"}),Object(C.jsx)("span",{style:{fontWeight:"200",fontSize:"13px",maxHeight:"100px",overflowY:"auto"},children:" ".concat(null===R||void 0===R||null===(E=R.workOrder)||void 0===E||null===(T=E.project)||void 0===T||null===(L=T.client)||void 0===L?void 0:L.clientName.slice(0,100),"  ")})]}),Object(C.jsx)(f.a,{label:"TimeSheet Status",name:"timeSheetStatus",value:null===R||void 0===R?void 0:R.timeSheetStatus,onChange:e=>V(e),options:[{id:1,value:"DRAFTED",name:"Drafted"},{id:2,value:"SUBMITTED",name:"Submitted"},{id:3,value:"SUBMITTED_UPDATED",name:"Submitted/Updated"},{id:4,value:"COLLECTED",name:"Collected"},{id:5,value:"PROCESSED",name:"Processed"},{id:6,value:"CLOSED",name:"Closed"}],required:!0}),Object(C.jsx)(D.a,{name:"submittedOn",label:" submitted On",type:"date",id:"submittedOn",max:"2999-12-31",onChange:e=>V(e),value:null===R||void 0===R?void 0:R.submittedOn})]}):Object(C.jsx)(C.Fragment,{children:Object(C.jsxs)("div",{className:"disabled-form-section small",children:[Object(C.jsx)("h3",{className:"disabled-form-section-header",children:"Basic Information"}),Object(C.jsxs)("div",{className:"disabled-form-section-content",children:[Object(C.jsxs)("span",{className:"disabled-form-text",children:[Object(C.jsx)("span",{className:"disabled-form-bold-text",children:"Worker:"}),"".concat(null===R||void 0===R||null===(e=R.worker)||void 0===e?void 0:e.firstName," ").concat(null===R||void 0===R||null===(t=R.worker)||void 0===t?void 0:t.lastName)]}),Object(C.jsxs)("span",{className:"disabled-form-text",children:[Object(C.jsx)("span",{className:"disabled-form-bold-text",children:"Time Period:"}),(null===R||void 0===R||null===(a=R.timesheetWeekDays)||void 0===a?void 0:a.mondayDate)+" to "+(null===R||void 0===R||null===(s=R.timesheetWeekDays)||void 0===s?void 0:s.sundayDate)]}),Object(C.jsxs)("span",{className:"disabled-form-text",children:[Object(C.jsx)("span",{className:"disabled-form-bold-text",children:"Work Order:"}),"".concat(null===R||void 0===R||null===(l=R.workOrder)||void 0===l?void 0:l.id," PRJ-").concat(null===R||void 0===R||null===(o=R.workOrder)||void 0===o||null===(i=o.project)||void 0===i||null===(d=i.client)||void 0===d?void 0:d.clientName.slice(0,3),"-000").concat(null===R||void 0===R||null===(c=R.workOrder)||void 0===c?void 0:c.id,"  ")]}),Object(C.jsxs)("span",{className:"disabled-form-text",children:[Object(C.jsx)("span",{className:"disabled-form-bold-text",children:"Client:"}),"".concat(null===R||void 0===R||null===(u=R.workOrder)||void 0===u||null===(v=u.project)||void 0===v||null===(j=v.client)||void 0===j?void 0:j.clientName)]}),Object(C.jsxs)("span",{className:"disabled-form-text",children:[Object(C.jsx)("span",{className:"disabled-form-bold-text",children:"TimeSheet Status "}),null===R||void 0===R?void 0:R.timeSheetStatus]}),Object(C.jsxs)("span",{className:"disabled-form-text",children:[Object(C.jsx)("span",{className:"disabled-form-bold-text",children:"Submitted On:"}),S()(null===R||void 0===R?void 0:R.submittedOn).format("MM/DD/YYYY")]})]})]})})},N=a(86),W=a(313);var H=()=>{var e,t,a,s,l,o,i;const{editEnabled:d}=Object(m.c)((e=>e.timesheet)),{timeSheetDetails:c}=Object(m.c)((e=>e.timesheet)),r=e=>u(Object(x.e)(e)),u=Object(m.b)(),{inputErr:b,requiredErr:v}=Object(m.c)((e=>e.timesheet)),j=e=>u(Object(g.d)(e)),h=e=>u(Object(g.b)(e)),O=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;h(!0);const a=Object(y.a)(t,e.target.value);let s;var l;""!==e.target.value&&(s={...v},delete s[e.target.name],l=s,u(Object(g.f)(l))),r({...c,[e.target.name]:e.target.value}),a?(s={...b},delete s[e.target.name],j(s)):j({...b,[e.target.name]:"Invalid format or characters"})},p=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const a=""===e.target.value,s=Object(y.a)(t,e.target.value,e.target.max);var l;console.log(s),(a||s)&&(l={[e.target.name]:e.target.value},h(!0),r({...c,timesheetWeekDays:{...c.timesheetWeekDays,...l}}))};return Object(C.jsxs)(n.Fragment,{children:[Object(C.jsx)("h3",{className:"disabled-form-section-header",children:"Comments"}),Object(C.jsx)(N.a,{type:"text",label:"Comments",name:"comments",value:(null===c||void 0===c?void 0:c.comments)||"",onChange:e=>O(e),maxLength:"3000",charCount:"".concat(null!==c&&void 0!==c&&c.comments?3e3-(null===c||void 0===c?void 0:c.comments.length):3e3," of 3000"),disabled:!d}),Object(C.jsx)("h3",{className:"disabled-form-section-header",children:"Week Days"}),Object(C.jsx)(W.a,{hidePagination:!0,headers:[{id:1,label:"Day"},{id:2,label:S()(null===c||void 0===c||null===(e=c.timesheetWeekDays)||void 0===e?void 0:e.mondayDate).format("MM/DD")+" Mon"},{id:3,label:S()(null===c||void 0===c||null===(t=c.timesheetWeekDays)||void 0===t?void 0:t.tuesdayDate).format("MM/DD")+" Tue"},{id:4,label:S()(null===c||void 0===c||null===(a=c.timesheetWeekDays)||void 0===a?void 0:a.wednesdayDate).format("MM/DD")+" Wed"},{id:5,label:S()(null===c||void 0===c||null===(s=c.timesheetWeekDays)||void 0===s?void 0:s.thursdayDate).format("MM/DD")+" Thur"},{id:6,label:S()(null===c||void 0===c||null===(l=c.timesheetWeekDays)||void 0===l?void 0:l.fridayDate).format("MM/DD")+" Fri"},{id:7,label:S()(null===c||void 0===c||null===(o=c.timesheetWeekDays)||void 0===o?void 0:o.saturdayDate).format("MM/DD")+" Sat"},{id:8,label:S()(null===c||void 0===c||null===(i=c.timesheetWeekDays)||void 0===i?void 0:i.sundayDate).format("MM/DD")+" sun"}],body:[""].map((()=>{var e,t,a,s,l,n,o;return{id:1,cells:[{id:1,data:"Hours"},{id:2,data:Object(C.jsx)("td",{children:Object(C.jsx)("input",{style:{paddingLeft:"100px"},type:"number",placeholder:"0h",min:"0",max:"24",id:0,name:"mondayHours",value:null===c||void 0===c||null===(e=c.timesheetWeekDays)||void 0===e?void 0:e.mondayHours,onChange:e=>p(e,"validateHours"),disabled:!d})})},{id:3,data:Object(C.jsx)("td",{children:Object(C.jsx)("input",{type:"number",placeholder:"0h",min:"0",max:"24",style:{paddingLeft:"100px"},id:1,name:"tuesdayHours",value:null===c||void 0===c||null===(t=c.timesheetWeekDays)||void 0===t?void 0:t.tuesdayHours,onChange:e=>p(e,"validateHours"),disabled:!d})})},{id:4,data:Object(C.jsx)("td",{children:Object(C.jsx)("input",{type:"number",placeholder:"0h",min:"0",max:"24",style:{paddingLeft:"100px"},id:2,name:"wednesdayHours",value:null===c||void 0===c||null===(a=c.timesheetWeekDays)||void 0===a?void 0:a.wednesdayHours,onChange:e=>p(e,"validateHours"),disabled:!d})})},{id:5,data:Object(C.jsx)("td",{children:Object(C.jsx)("input",{type:"number",placeholder:"0h",min:"0",max:"24",style:{paddingLeft:"100px"},id:3,name:"thursdayHours",value:null===c||void 0===c||null===(s=c.timesheetWeekDays)||void 0===s?void 0:s.thursdayHours,onChange:e=>p(e,"validateHours"),disabled:!d})})},{id:6,data:Object(C.jsx)("td",{children:Object(C.jsx)("input",{type:"number",placeholder:"0h",min:"0",max:"24",id:4,style:{paddingLeft:"100px"},name:"fridayHours",value:null===c||void 0===c||null===(l=c.timesheetWeekDays)||void 0===l?void 0:l.fridayHours,onChange:e=>p(e,"validateHours"),disabled:!d})})},{id:7,data:Object(C.jsx)("td",{children:Object(C.jsx)("input",{type:"number",placeholder:"0h",min:"0",max:"24",id:5,style:{paddingLeft:"100px"},name:"saturdayHours",value:null===c||void 0===c||null===(n=c.timesheetWeekDays)||void 0===n?void 0:n.saturdayHours,onChange:e=>p(e,"validateHours"),disabled:!d})})},{id:8,data:Object(C.jsx)("td",{children:Object(C.jsx)("input",{type:"number",placeholder:"0h",min:"0",max:"24",id:6,name:"sundayHours",style:{paddingLeft:"100px"},value:null===c||void 0===c||null===(o=c.timesheetWeekDays)||void 0===o?void 0:o.sundayHours,onChange:e=>p(e,"validateHours"),disabled:!d})})}]}}))})]})},M=a(826),E=a(781),T=a(685),L=a(783),I=a(219),R=a(218),Y=a(420),F=a(152),P=a(310),z=a(786);t.default=()=>{var e,t,a,j;const f=Object(u.useParams)(),[g,y]=Object(n.useState)(!0),[D]=Object(n.useState)(r.a.getHeaders()),k=Object(u.useHistory)(),[S,N]=Object(n.useState)(!1),[W]=Object(n.useState)("".concat(b.a.serverURL,"/timesheet")),[A]=Object(n.useState)({}),[U,q]=Object(n.useState)(!1),{editEnabled:B}=Object(m.c)((e=>e.timesheet)),{timeSheetDetails:V}=Object(m.c)((e=>e.timesheet)),{requiredErr:J}=Object(m.c)((e=>e.timesheet)),{changesMade:K}=Object(m.c)((e=>e.timesheet)),X=Object(m.b)(),[_,G]=Object(n.useState)({}),[Q,Z]=(Object(n.useMemo)((()=>r.a.isAdminOrOperations()),[]),Object(n.useState)(!0)),[$,ee]=Object(n.useState)(!1),[te,ae]=Object(n.useState)("1"),se=Object(n.useMemo)((()=>r.a.getUserInfo()),[]),[le,ne]=Object(n.useState)(se.roles[0]),[oe,ie]=Object(n.useState)(!1),[de,ce]=Object(n.useState)(!1);Object(n.useEffect)((()=>{r.a.hasAdminRole()&&ie(!0)}),[]);const re=Object(n.useCallback)((()=>{X(Object(O.b)(!1)),r.a.logout()}),[X]),ue=Object(n.useCallback)((e=>X(Object(x.b)(e))),[X]),me=Object(n.useCallback)((e=>X(Object(x.e)(e))),[X]),be=Object(n.useCallback)((e=>X(Object(x.d)(e))),[X]),ve=Object(n.useCallback)((e=>X(Object(x.c)(e))),[X]),je=Object(n.useCallback)((async()=>{try{const e=f.timesheetId||V.id,t=await Object(M.c)(D,e);200===t.statusCode?(be(t.timeSheetData),me(t.timeSheetData)):401===t.statusCode&&re()}catch(e){console.log(e)}}),[D,null===V||void 0===V?void 0:V.id,f.timesheetId,be,me,re]);Object(n.useEffect)((()=>{je()}),[je]);console.log(V);const he=async e=>{e.preventDefault();const t="isLoading",a={...V};try{const e=await Object(M.f)(D,a,V.id);200===e.statusCode?(xe(),y(!0),me(e.data),Y.b.success({content:"timesheet updated!",messgKey:t,duration:5,style:{marginTop:"5%"}})):Y.b.error({content:"An error occurred while saving changes (".concat(e.statusCode,")"),messgKey:t,duration:10})}catch(l){var s;401===(null===(s=l.response)||void 0===s?void 0:s.status)&&re()}},Oe=()=>{N(!1),G({})},pe=()=>{me(),ue(!1)},xe=()=>{ue(!1)};return console.log(V),Object(C.jsxs)(I.a,{children:[Object(C.jsx)(F.a,{onActive:()=>{Z(!0)},onIdle:()=>{Z(!1)},onLogout:()=>{ee(!0)}}),Object(C.jsx)(R.a,{breadcrumbs:Object(C.jsx)(o.a,{className:"header",crumbs:[{id:0,text:"All TimeSheet",onClick:()=>(xe(),ue(!1),void k.push("/viewtimesheet"))},{id:1,text:"".concat(null===V||void 0===V||null===(e=V.worker)||void 0===e?void 0:e.firstName," ").concat(null===V||void 0===V||null===(t=V.worker)||void 0===t?void 0:t.lastName),lastCrumb:!0}]}),actions:oe||le.workerPermission?Object(C.jsxs)(d.a,{children:[Object(C.jsx)(i.a,{type:"button",handleClick:()=>{B?pe():(ue(!B),y(!g))},className:"btn icon marginX",title:"Edit",children:Object(C.jsx)(E.a,{})}),Object(C.jsx)(i.a,{type:"button",disabled:!0,className:"btn icon marginX",title:"Share",children:Object(C.jsx)(T.a,{})}),Object(C.jsx)(i.a,{type:"button",disabled:!0,className:"btn icon marginX",title:"Export Report",children:Object(C.jsx)(L.a,{})})]}):""}),Object(C.jsxs)(c.a,{children:[U&&Object(C.jsx)("span",{className:"fixed-error-banner",children:"Resolve errors before submitting: ".concat(Object.keys(A).concat(Object.keys(J)).join(", "))}),Object(C.jsx)(s.a,{className:"x-small",children:Object(C.jsx)(l.a,{className:"column small",onSubmit:e=>{if(e.preventDefault(),Object.keys(A).length>0||Object.keys(J).length>0)q(!0);else{q(!1);const t={};h.a.post("".concat(W,"/checks/").concat(V.id),t,{headers:D}).then((t=>{200===t.status&&he(e)})).catch((e=>{v.d(e),N(!0),G({title:"Error",details:"".concat(e.response.data),confirmValue:"Close"})}))}},cancel:()=>{K?(N(!0),G({title:"Confirm Discard Changes",details:"All changes will be discarded, proceed?",confirmValue:"Confirm",cancelValue:"Cancel"})):ue(!1)},formEnabled:B,children:Object(C.jsx)(w,{logout:re,handleRequiredCheck:e=>{if(""===e.target.value)ve({...J,[e.target.name]:"Field is required"});else{let t={...J};delete t[e.target.name],ve(t)}}})})}),Object(C.jsx)(s.a,{className:"medium",children:Object(C.jsx)(P.a,{activeKey:te,setActiveKey:e=>{ae(e)},position:"top",items:[{key:"1",label:Object(C.jsxs)("span",{children:[Object(C.jsx)(z.a,{}),"Comments"]}),children:Object(C.jsx)(H,{})}]})})]}),Object(C.jsx)(p.a,{openModal:S,type:(null===(a=_.title)||void 0===a?void 0:a.toLowerCase())||"",closePopUp:Oe,handleConfirmClose:null!==(j=_.title)&&void 0!==j&&j.includes("Confirm")?pe:Oe,confirmValue:_.confirmValue,cancelValue:_.cancelValue,message:_})]})}},826:function(e,t,a){"use strict";a.d(t,"d",(function(){return m})),a.d(t,"b",(function(){return v})),a.d(t,"e",(function(){return j})),a.d(t,"a",(function(){return h})),a.d(t,"c",(function(){return O})),a.d(t,"f",(function(){return p}));var s=a(25),l=a(13),n=a(16),o=a.n(n),i=a(11),d=a.n(i);const c="".concat(s.a.serverURL,"/timesheet"),r=e=>{var t,a;if(!e.response)throw new Error;return 401===(null===(t=e.response)||void 0===t?void 0:t.status)&&l.a.logout(),{status:null===(a=e.response)||void 0===a?void 0:a.status,err:e}},u=e=>e.map((e=>({...e}))),m=async function(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const a="".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"").concat(t);return await b(e,a)},b=async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{const s=await o.a.get("".concat(c).concat(t).concat(a),{headers:e});let l={};return 200===s.status&&(l.tableData=u(s.data),l.totalItems=s.headers["total-elements"],l.statusCode=s.status),l}catch(n){var s;return 401===n.response.status&&l.a.logout(),{statusCode:null===(s=n.response)||void 0===s?void 0:s.status}}},v=async(e,t,a,s,l)=>{try{const n=s||l?s?"?dropdownFilter=true&pageNo=".concat(t-1,"&pageSize=").concat(a,"&").concat(s):"?dropdownFilter=true&pageNo=".concat(t-1,"&pageSize=").concat(a):"?pageNo=".concat(t-1,"&pageSize=-1"),i=l?await o.a.put("".concat(c).concat(n),l,{headers:e}):await o.a.get("".concat(c).concat(n),{headers:e});if(200===i.status)return{data:i.data.length?u(i.data):[],totalItems:i.headers["total-elements"],status:i.status}}catch(n){return r(n)}},j=async(e,t,a)=>{try{const s=await o.a.get("".concat(c,"?archives=true&pageNo=").concat(t-1,"&pageSize=").concat(a),{headers:e});if(s)return{data:s.data.map((e=>{var t,a,s,l;return{id:e.id,cellOne:"".concat(null===(t=e.worker)||void 0===t?void 0:t.firstName," ").concat(null===(a=e.worker)||void 0===a?void 0:a.lastName),cellTwo:null===e||void 0===e||null===(s=e.workOrder)||void 0===s||null===(l=s.project)||void 0===l?void 0:l.projectName,cellThree:null===e||void 0===e?void 0:e.timeSheetStatus,cellFour:e.updatedOn?d()(e.updatedOn).format("MM/DD/YYYY"):"",cellFive:e.statusChangedOn?d()(e.statusChangedOn).format("MM/DD/YYYY"):"",cellSix:e.billableHours||"",cellSeven:e.comments||""}})),totalItems:s.headers["total-elements"]}}catch(s){console.log(s)}},h=async(e,t)=>{try{const a=await o.a.all(t.map((t=>o.a.delete("".concat(c,"/").concat(t),{headers:e}))));if(a.length)return a[0].status}catch(a){return r(a)}},O=async(e,t)=>{try{const a=await o.a.get("".concat(s.a.serverURL,"/timesheet/").concat(t),{headers:e});let l={};return 200===a.status&&(l.timeSheetData=a.data,l.Details=a.data,l.statusCode=a.status),l}catch(l){var a;return console.log(l),{statusCode:null===(a=l.response)||void 0===a?void 0:a.status}}},p=async(e,t,a)=>{try{const s=await o.a.put("".concat(c,"/update/").concat(a),t,{headers:e});if(200===s.status)return{statusCode:200,data:s.data};if(401===s.status)return{statusCode:401}}catch(s){return console.log(s),{statusCode:s.response.status}}}}}]);