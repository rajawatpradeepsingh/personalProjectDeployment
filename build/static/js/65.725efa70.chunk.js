(this.webpackJsonpreactfrontend=this.webpackJsonpreactfrontend||[]).push([[65],{1100:function(e,t,a){"use strict";a.r(t);var s=a(0),c=a(75),r=a(28),n=a(13),o=a(16),l=a.n(o),d=a(25),i=a(91),u=a(349),b=a(825),j=a(310),m=a(219),v=a(218),O=a(306),h=a(307),p=a(137),g=a(96),f=a(35),x=a(95),N=a(27),k=a(11),C=a.n(k),w=a(1);var y=()=>{var e,t,a,c,o;const{editEnabled:i}=Object(r.c)((e=>e.workOrder)),{basicInfo:b}=Object(r.c)((e=>e.workOrder)),j=e=>m(Object(u.b)(e)),m=Object(r.b)(),[v,O]=Object(s.useState)([]),{inputErr:h,requiredErr:p}=Object(r.c)((e=>e.workOrder)),g=e=>m(Object(u.e)(e)),[k,y]=Object(s.useState)(null);Object(s.useEffect)((()=>{(()=>{if(n.a.hasAdminRole()||n.a.hasRecruiterRole()){let e=JSON.parse(sessionStorage.getItem("headers"));l.a.get(d.a.serverURL+"/worker?dropdownFilter=true",{headers:e}).then((e=>{const t=e.data;e.data&&O(t)})).catch((e=>{console.log(e),e.response&&401===e.response.status&&n.a.logout()}))}})()}),[]);const D=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;var a;a=!0,m(Object(u.c)(a));const s=Object(x.a)(t,e.target.value);let c;""!==e.target.value&&(c={...p},delete c[e.target.name],(e=>{m(Object(u.f)(e))})(c)),j({...b,[e.target.name]:e.target.value}),s?(c={...h},delete c[e.target.name],g(c)):g({...h,[e.target.name]:"Invalid format or characters"})};return i?Object(w.jsxs)(s.Fragment,{children:[Object(w.jsx)("h3",{className:"disabled-form-section-header",children:"Basic Information"}),Object(w.jsx)(N.a,{type:"date",label:"Active Date",name:"activeDate",min:k,max:"2999-12-31",onChange:e=>D(e),value:null===b||void 0===b?void 0:b.activeDate,disabled:!i}),Object(w.jsx)(N.a,{label:"Project",type:"text",name:"projectName",onChange:e=>D(e,"validateName"),value:null===b||void 0===b||null===(c=b.project)||void 0===c?void 0:c.projectName,disabled:!0}),Object(w.jsx)(f.a,{label:"Worker Name",name:"workerId","data-testid":"worker-options",value:(null===b||void 0===b||null===(o=b.worker)||void 0===o?void 0:o.id)||"",required:!0,onChange:e=>{let t=v.filter((t=>+t.id===+e.target.value))[0];j({...b,worker:{id:t.id}})},options:v.map((e=>({id:e.id,name:"".concat(e.firstName," ").concat(e.lastName)})))}),Object(w.jsx)(N.a,{type:"date",label:"Start Date",name:"startDate",id:"startDate",max:"2999-12-31",disabled:!0,onChange:e=>D(e),value:null===b||void 0===b?void 0:b.startDate}),Object(w.jsx)(N.a,{type:"date",label:"End Date",name:"endDate",id:"endDate",min:k,max:"2999-12-31",onChange:e=>D(e),value:null===b||void 0===b?void 0:b.endDate,disabled:!0}),Object(w.jsx)(N.a,{type:"number",label:"C2C Pay Rate/hr",name:"payRate",value:Number(null===b||void 0===b?void 0:b.payRate).toFixed(2),onChange:e=>D(e,"validateHasDecimal"),disabled:!0}),Object(w.jsx)(N.a,{type:"number",label:"Rebate Adjusted Bill Rate/hr",name:"billRate",value:Number(null===b||void 0===b?void 0:b.billRate).toFixed(2),onChange:e=>D(e,"validateHasDecimal"),disabled:!0}),Object(w.jsx)(N.a,{label:"Margin/hr",type:"number",name:"margin",value:Number(null===b||void 0===b?void 0:b.margin).toFixed(2),disabled:!0})]}):Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)("div",{className:"disabled-form-section small",children:[Object(w.jsx)("h3",{className:"disabled-form-section-header",children:"Basic Information"}),Object(w.jsxs)("div",{className:"disabled-form-section-content",children:[Object(w.jsxs)("span",{className:"disabled-form-text",children:[Object(w.jsx)("span",{className:"disabled-form-bold-text",children:"Active Date:"}),C()(null===b||void 0===b?void 0:b.activeDate).format("MM/DD/YYYY")]}),Object(w.jsxs)("span",{className:"disabled-form-text",children:[Object(w.jsx)("span",{className:"disabled-form-bold-text",children:"Project Name:"}),null===b||void 0===b||null===(e=b.project)||void 0===e?void 0:e.projectName]}),Object(w.jsxs)("span",{className:"disabled-form-text",children:[Object(w.jsx)("span",{className:"disabled-form-bold-text",children:"worker:"}),"".concat(null===b||void 0===b||null===(t=b.worker)||void 0===t?void 0:t.firstName," ").concat(null===b||void 0===b||null===(a=b.worker)||void 0===a?void 0:a.lastName),","]}),Object(w.jsxs)("span",{className:"disabled-form-text",children:[Object(w.jsx)("span",{className:"disabled-form-bold-text",children:"Start Date:"}),C()(null===b||void 0===b?void 0:b.startDate).format("MM/DD/YYYY")]}),Object(w.jsxs)("span",{className:"disabled-form-text",children:[Object(w.jsx)("span",{className:"disabled-form-bold-text",children:"End Date:"}),C()(null===b||void 0===b?void 0:b.endDate).format("MM/DD/YYYY")]}),Object(w.jsxs)("span",{className:"disabled-form-align",children:[Object(w.jsx)("span",{className:"disabled-form-bold-text",children:"C2C Pay Rate/hr:"}),Number(null===b||void 0===b?void 0:b.payRate).toFixed(2)]}),Object(w.jsxs)("span",{className:"disabled-form-align",children:[Object(w.jsx)("span",{className:"disabled-form-bold-text",children:"Rebate Adjusted Bill Rate/hr:"}),Number(null===b||void 0===b?void 0:b.billRate).toFixed(2)]}),Object(w.jsxs)("span",{className:"disabled-form-align",children:[Object(w.jsx)("span",{className:"disabled-form-bold-text",children:"Margin/hr:"}),Number(null===b||void 0===b?void 0:b.margin).toFixed(2)]})]})]})})},D=a(66),R=a(22),Y=a(152),S=a(781),M=a(685),F=a(783),E=a(50),I=a(420);t.default=()=>{var e,t,a,o;const f=Object(r.b)(),x=Object(c.useHistory)(),N=Object(c.useParams)(),k=Object(s.useMemo)((()=>n.a.getHeaders()),[]),C=Object(s.useMemo)((()=>"".concat(d.a.serverURL,"/workOrders")),[]),{basicInfo:A}=Object(r.c)((e=>e.workOrder)),{changesMade:L}=Object(r.c)((e=>e.workOrder)),{requiredErr:P}=Object(r.c)((e=>e.workOrder)),{editEnabled:U,showWorkOrderDetails:V}=Object(r.c)((e=>e.workOrder)),[q,X]=Object(s.useState)(!0),[z,B]=Object(s.useState)("1"),[H]=Object(s.useState)({}),[J,K]=Object(s.useState)(!1),[T,W]=Object(s.useState)({}),[G,Q]=Object(s.useState)(!1),[Z,$]=Object(s.useState)(!0),[_]=Object(s.useState)(!1),ee=Object(s.useCallback)((()=>{f(Object(i.b)(!1)),n.a.logout()}),[f]),te=()=>{Q(!1),W({})},ae=()=>{re(!1)},se=Object(s.useCallback)((e=>f(Object(u.h)(e))),[f]),ce=Object(s.useCallback)((e=>f(Object(u.b)(e))),[f]),re=Object(s.useCallback)((e=>{f(Object(u.d)(e)),B("1")}),[f]),ne=(Object(s.useCallback)((e=>f(Object(u.c)(e))),[f]),()=>{L?(Q(!0),W({title:"Confirm Discard Changes",details:"All changes will be discarded, proceed?",confirmValue:"Confirm",cancelValue:"Cancel"})):re(!1)});Object(s.useEffect)((()=>{V&&B("2")}),[V]);const oe=Object(s.useCallback)((e=>f(Object(u.f)(e))),[f]),le=e=>{if(e.preventDefault(),Object.keys(H).length>0||Object.keys(P).length>0)K(!0);else{K(!1);const t={projectName:A.projectName};l.a.post("".concat(C,"/checks/").concat(A.id),t,{headers:k}).then((t=>{200===t.status&&de(e)})).catch((e=>{E.d(e),Q(!0),W({title:"Error",details:"".concat(e.response.data),confirmValue:"Close"})}))}},de=async e=>{e.preventDefault();const t="isLoading",a={...A};try{const e=await Object(b.f)(k,a,A.id);200===e.statusCode?(ae(),X(!0),ce(e.data),I.b.success({content:"workOrder updated!",messgKey:t,duration:5,style:{marginTop:"5%"}})):I.b.error({content:"An error occurred while saving changes (".concat(e.statusCode,")"),messgKey:t,duration:10})}catch(c){var s;401===(null===(s=c.response)||void 0===s?void 0:s.status)&&ee()}},ie=Object(s.useCallback)((async()=>{try{const e=N.workOrderId||A.id;if(!e)return;const t=await Object(b.b)(k,e);200===t.statusCode?ce(t.workOrderData):401===t.statusCode&&ee()}catch(e){console.log(e)}}),[null===N||void 0===N?void 0:N.workOrderId,null===A||void 0===A?void 0:A.id,k,ce,ee]);Object(s.useEffect)((()=>{ie()}),[ie]);console.log(A);const ue=()=>{se({}),re(!1),ie(),Q(!1),oe({}),K(!1)};return Object(w.jsxs)(m.a,{children:[Object(w.jsx)(v.a,{breadcrumbs:Object(w.jsx)(O.a,{className:"header",crumbs:[{id:0,text:"WorkOrder",onClick:()=>(ae(),re(!1),void x.push("/viewworkOrder"))},{id:1,text:"PRJ-".concat(null===A||void 0===A||null===(e=A.project)||void 0===e||null===(t=e.client)||void 0===t?void 0:t.clientName.toUpperCase().substr(0,3),"-").concat(("00"+(null===A||void 0===A?void 0:A.id)).slice(-5)),lastCrumb:!0}]}),actions:Object(w.jsxs)(w.Fragment,{children:[U&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(R.a,{type:"button",handleClick:le,className:"btn main submit marginX",children:"Save Changes"}),Object(w.jsx)(R.a,{type:"button",handleClick:ne,className:"btn main reset marginX",children:"Cancel"})]}),Object(w.jsxs)(h.a,{children:[Object(w.jsx)(R.a,{type:"button",handleClick:()=>{U?ue():(re(!U),X(!q))},className:"btn icon marginX",title:"Edit",children:Object(w.jsx)(S.a,{})}),Object(w.jsx)(R.a,{type:"button",handleClick:()=>console.log("put onClick handler, but not an object"),disabled:!0,className:"btn icon marginX",title:"Share",children:Object(w.jsx)(M.a,{})}),Object(w.jsx)(R.a,{type:"button",handleClick:()=>console.log("put onClick handler, but not an object"),disabled:!0,className:"btn icon marginX",title:"Export Report",children:Object(w.jsx)(F.a,{})})]})]})}),Object(w.jsx)(Y.a,{onActive:()=>{$(!0)},onIdle:()=>{$(!1)},onLogout:()=>{_(!0)}}),Object(w.jsxs)("div",{className:"multi-content-container",children:[J&&Object(w.jsx)("span",{className:"fixed-error-banner",children:"Resolve errors before submitting: ".concat(Object.keys(H).concat(Object.keys(P)).join(", "))}),Object(w.jsx)(p.a,{className:"x-small",children:Object(w.jsx)(D.a,{className:"column small",onSubmit:le,cancel:ne,formEnabled:U,children:Object(w.jsx)(y,{logout:ee,handleRequiredCheck:e=>{if(""===e.target.value)oe({...P,[e.target.name]:"Field is required"});else{let t={...P};delete t[e.target.name],oe(t)}}})})}),Object(w.jsx)(p.a,{className:"medium",children:Object(w.jsx)(j.a,{activeKey:z,setActiveKey:e=>{B(e),f(Object(u.g)(!1))},items:[]})})]}),Object(w.jsx)(g.a,{openModal:G,type:(null===(a=T.title)||void 0===a?void 0:a.toLowerCase())||"",closePopUp:te,handleConfirmClose:null!==(o=T.title)&&void 0!==o&&o.includes("Confirm")?ue:te,confirmValue:T.confirmValue,cancelValue:T.cancelValue,message:T})]})}},825:function(e,t,a){"use strict";a.d(t,"e",(function(){return b})),a.d(t,"b",(function(){return m})),a.d(t,"c",(function(){return v})),a.d(t,"f",(function(){return O})),a.d(t,"d",(function(){return h})),a.d(t,"a",(function(){return p}));var s=a(25),c=a(13),r=a(16),n=a.n(r),o=a(11),l=a.n(o);const d="".concat(s.a.serverURL,"/workOrders"),i=e=>{var t,a;if(!e.response)throw new Error;return 401===(null===(t=e.response)||void 0===t?void 0:t.status)&&c.a.logout(),{status:null===(a=e.response)||void 0===a?void 0:a.status,err:e}},u=e=>e.map((e=>({...e}))),b=async function(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const a="".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"").concat(t);return await j(e,a)},j=async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{const s=await n.a.get("".concat(d).concat(t).concat(a),{headers:e});let c={};return 200===s.status&&(c.tableData=u(s.data),c.totalItems=s.headers["total-elements"],c.statusCode=s.status),c}catch(r){var s;return 401===r.response.status&&c.a.logout(),{statusCode:null===(s=r.response)||void 0===s?void 0:s.status}}},m=async(e,t)=>{try{const a=await n.a.get("".concat(s.a.serverURL,"/workOrders/").concat(t),{headers:e});let c={};return 200===a.status&&(c.workOrderData=a.data,c.Details=a.data,c.statusCode=a.status),c}catch(c){var a;return console.log(c),{statusCode:null===(a=c.response)||void 0===a?void 0:a.status}}},v=async(e,t,a,s,c)=>{try{const r=s||c?s?"?dropdownFilter=true&pageNo=".concat(t-1,"&pageSize=").concat(a,"&").concat(s):"?dropdownFilter=true&pageNo=".concat(t-1,"&pageSize=").concat(a):"?pageNo=".concat(t-1,"&pageSize=-1"),o=c?await n.a.put("".concat(d).concat(r),c,{headers:e}):await n.a.get("".concat(d).concat(r),{headers:e});if(200===o.status)return{data:o.data,totalItems:o.headers["total-elements"],status:o.status}}catch(r){return i(r)}},O=async(e,t,a)=>{try{const c=await n.a.patch("".concat(s.a.serverURL,"/workOrders/").concat(a),t,{headers:e});if(200===c.status)return{statusCode:200,data:c.data};if(401===c.status)return{statusCode:c.status}}catch(o){var r;return 401===o.response.status&&c.a.logout(),{statusCode:null===(r=o.response)||void 0===r?void 0:r.status}}},h=async(e,t,a)=>{try{const s=await n.a.get("".concat(d,"?archives=true&pageNo=").concat(t-1,"&pageSize=").concat(a),{headers:e});if(s)return{data:s.data.map((e=>{var t,a,s,c,r;return{id:e.id,cellOne:null===(t=e.project)||void 0===t?void 0:t.projectName,cellTwo:"".concat(null===(a=e.worker)||void 0===a?void 0:a.firstName," ").concat(null===(s=e.worker)||void 0===s?void 0:s.lastName),cellThree:e.startDate?l()(e.startDate).format("MM/DD/YYYY"):"",cellFour:e.endDate?l()(e.endDate).format("MM/DD/YYYY"):"",cellFive:"".concat(null===(c=e.project.resourceManager)||void 0===c?void 0:c.firstName," ").concat(null===(r=e.project.resourceManager)||void 0===r?void 0:r.lastName),cellSix:e.activeDate?l()(e.activeDate).format("MM/DD/YYYY"):""}})),totalItems:s.headers["total-elements"]}}catch(s){console.log(s)}},p=async(e,t)=>{try{const a=await n.a.all(t.map((t=>n.a.delete("".concat(d,"/").concat(t),{headers:e}))));if(a.length)return a[0].status}catch(a){return i(a)}}}}]);