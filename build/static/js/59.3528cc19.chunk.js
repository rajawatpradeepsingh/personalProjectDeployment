(this.webpackJsonpreactfrontend=this.webpackJsonpreactfrontend||[]).push([[59],{1043:function(t,e,a){"use strict";a.r(e),a.d(e,"default",(function(){return O}));var s=a(0),i=a(25),r=a(137),n=a(66),o=a(27),l=a(306),c=a(96),h=a(106),d=a(219),p=a(218),u=a(16),g=a.n(u),j=a(95),m=a(13),v=(a(152),a(35)),b=(a(851),a(1));class O extends s.Component{constructor(t){var e;super(t),e=this,this.initialState={projectName:"",hiringManager:"",clientOptions:[],workerOptions:[],clientName:"",clientId:"",workerId:"",resourceManagerOptions:[],resourceManager:"",resourceManagerId:"",worker:"",client:"",workerName:"",clientRate:"",billRate:"",netBillRate:"",billRateType:"",startDate:"",endDate:"",activeDate:"",state:"",preBillRate:"",preNetBillRate:"",isDeleted:!1,inputErr:""},this.getWorkers=()=>{let t=JSON.parse(sessionStorage.getItem("headers"));g.a.get(i.a.serverURL+"/worker?dropdownFilter=true",{headers:t}).then((t=>{const e=t.data;t.data&&this.setState({workerOptions:e})})).catch((t=>{console.log(t),t.response&&401===t.response.status&&m.a.logout()}))},this.getResourceManager=()=>{let t=JSON.parse(sessionStorage.getItem("headers"));g.a.get(i.a.serverURL+"/resourcemanager?dropdownFilter=true&role=SALESMANAGER",{headers:t}).then((t=>{const e=t.data;t.data&&this.setState({resourceManagerOptions:e})})).catch((t=>{console.log(t),t.response&&401===t.response.status&&m.a.logout()}))},this.projectChange=function(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=""===t.target.value,i=Object(j.a)(a,t.target.value,t.target.max);(s||i)&&e.setState({[t.target.name]:t.target.value})},this.showModal=()=>{this.setState({show:!this.state.show})},this.resetProjects=()=>{this.setState((()=>this.initialState))},this.closeForm=()=>{this.props.history.push("/viewprojects")},this.closePopUp=()=>{this.setState({show:!1})},this.togglePopUp=()=>{this.setState({openPopUp:!this.state.openPopUp})},this.getClients=()=>{let t=JSON.parse(sessionStorage.getItem("headers"));g.a.get(i.a.serverURL+"/clients?dropdownFilter=true",{headers:t}).then((t=>{const e=t.data;t.data&&this.setState({clientOptions:e})})).catch((t=>{console.log(t),t.response&&401===t.response.status&&m.a.logout()}))},this.setClientAddr=t=>{const e=this.state.clientOptions.filter((e=>+e.id===+t)).pop().address;this.setState({address:{city:(null===e||void 0===e?void 0:e.city)||"",country:(null===e||void 0===e?void 0:e.country)||"",postalCode:(null===e||void 0===e?void 0:e.postalCode)||"",state:(null===e||void 0===e?void 0:e.state)||""}})},this.state={...this.initialState},this.sumbitprojects=this.sumbitprojects.bind(this),this.projectChange=this.projectChange.bind(this)}sumbitprojects(t){t.preventDefault();const e={projectName:this.state.projectName,hiringManager:this.state.hiringManager,client:""===this.state.clientId?null:{id:this.state.clientId},worker:""===this.state.workerId?null:{id:this.state.workerId},resourceManager:""===this.state.resourceManagerId?null:{resourceManagerId:this.state.resourceManagerId},clientRate:this.state.clientRate,billRate:this.state.billRate,netBillRate:this.state.netBillRate,billRateType:this.state.billRateType,startDate:this.state.startDate,endDate:this.state.endDate,activeDate:this.state.activeDate,state:this.state.state,preBillRate:this.state.preBillRate,preNetBillRate:this.state.preNetBillRate,isDeleted:!1};let a=JSON.parse(sessionStorage.getItem("headers"));g.a.post("".concat(i.a.serverURL,"/projects"),e,{headers:a}).then((t=>{console.log(e),null!=t.data&&(this.resetProjects(),this.setState({show:!0,message:"To view projects go to ",status:"Success"}))})).catch((t=>{this.setState({show:!0,message:t.response.data,status:"Error in adding"}),console.log(t)}))}componentDidMount(){this.getClients(),this.getWorkers(),this.getResourceManager(),this.setState({setIsActive:!0,setLogout:!1})}componentDidUpdate(t,e){if(this.props.navMenuOpen!==t.navMenuOpen&&this.setState({navMenuOpen:this.props.navMenuOpen}),(this.state.startDate!==e.startDate||this.state.endDate!==e.endDate)&&this.state.endDate)if(this.state.startDate>=this.state.endDate)this.setState({inputErr:{...this.state.inputErr,endDate:"End date can't be before start date"}});else{let t={...this.state.inputErr};delete t.endDate,this.setState({inputErr:t})}}render(){var t,e,a,i;const{clientId:u,workerId:g,resourceManagerId:j}=this.state;return Object(b.jsxs)(d.a,{children:[Object(b.jsx)(p.a,{breadcrumbs:Object(b.jsx)(l.a,{className:"header",crumbs:[{id:0,text:"Projects",onClick:()=>this.closeForm()},{id:1,text:"Add Projects",lastCrumb:!0}]})}),Object(b.jsxs)(r.a,{children:[Object(b.jsx)(n.a,{onSubmit:this.sumbitprojects,formEnabled:!0,cancel:this.resetProjects,children:Object(b.jsxs)(s.Fragment,{children:[Object(b.jsx)(v.a,{label:"Client",name:"clientId","data-testid":"client-options",onChange:t=>{this.projectChange(t),this.setClientAddr(t.target.value)},value:u,options:this.state.clientOptions.map((t=>{var e;return{id:t.id,name:"".concat(t.clientName," (").concat((null===(e=t.address)||void 0===e?void 0:e.city)||"",")")}})),required:!0}),Object(b.jsx)(o.a,{label:"Project Name",type:"text",name:"projectName",onChange:t=>this.projectChange(t,"validateName"),value:this.state.projectName,required:!0}),Object(b.jsx)(o.a,{label:"Hiring Manager",type:"text",name:"hiringManager",onChange:t=>this.projectChange(t,"validateName"),value:this.state.hiringManager}),Object(b.jsx)(v.a,{label:"Resource Manager",name:"resourceManagerId","data-testid":"resourceManager-options",onChange:t=>{this.projectChange(t)},value:j,options:this.state.resourceManagerOptions.map((t=>({id:t.resourceManagerId,name:"".concat(t.firstName," ").concat(t.lastName)}))),required:!0}),Object(b.jsx)(o.a,{type:"date",label:"Start Date",name:"startDate",id:"startDate",max:"2999-12-31",value:this.state.startDate,onChange:t=>this.projectChange(t),errMssg:this.state.inputErr.startDate}),Object(b.jsx)(o.a,{type:"date",label:"End Date",name:"endDate",id:"endDate",max:"2999-12-31",value:this.state.endDate,onChange:t=>this.projectChange(t),errMssg:this.state.inputErr.endDate}),Object(b.jsx)(o.a,{type:"text",label:"client Rate",name:"clientRate",value:Number(this.state.clientRate).toFixed(2),onChange:t=>this.projectChange(t,"validateHasDecimal"),style:{textAlign:"right"},className:"right-align"}),Object(b.jsx)(o.a,{type:"text",label:"VMS Adjusted Bill Rate",name:"billRate",value:Number(this.state.billRate).toFixed(2),onChange:t=>this.projectChange(t,"validateHasDecimal"),className:"right-align"}),Object(b.jsx)(o.a,{type:"text",label:"Rebate Adjusted Bill Rate",name:"netBillRate",value:Number(this.state.netBillRate).toFixed(2),onChange:t=>this.projectChange(t,"validateHasDecimal"),required:!0,className:"right-align"}),Object(b.jsx)(v.a,{label:"worker",name:"workerId","data-testid":"worker-options",onChange:t=>{this.projectChange(t)},value:g,options:this.state.workerOptions.map((t=>({id:t.id,name:"".concat(null===t||void 0===t?void 0:t.firstName," ").concat(null===t||void 0===t?void 0:t.lastName)}))),required:!0})]})}),Object(b.jsx)(c.a,{openModal:this.state.show,closePopUp:this.closePopUp,type:null===(t=this.state)||void 0===t?void 0:t.status,message:{title:"Error"===(null===(e=this.state)||void 0===e?void 0:e.status)?"Error":"projects Added Succesfully",details:null===(a=this.state)||void 0===a?void 0:a.message},link:"Error"===(null===(i=this.state)||void 0===i?void 0:i.status)?"":Object(b.jsx)(h.b,{to:"viewprojects",children:"projects"})})]})]})}}},851:function(t,e,a){}}]);