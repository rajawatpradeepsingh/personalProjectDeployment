(this.webpackJsonpreactfrontend=this.webpackJsonpreactfrontend||[]).push([[35],{1073:function(e,t,a){"use strict";a.r(t),a.d(t,"ViewCommission",(function(){return E}));var s=a(219),c=a(218),n=a(22),o=a(762),r=a(13),l=a(0),i=a(75),u=a(16),d=a.n(u),m=a(420),b=a(25),j=a(28),h=a(152),v=a(804),O=a(91),p=a(806);const f="".concat(b.a.serverURL,"/commission"),g=e=>e.map((e=>({...e}))),x=async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{const s=await d.a.get("".concat(f).concat(t).concat(a),{headers:e});let c={};return 200===s.status&&(c.tableData=g(s.data),c.totalItems=s.headers["total-elements"],c.statusCode=s.status),c}catch(c){var s;return 401===c.response.status&&r.a.logout(),{statusCode:null===(s=c.response)||void 0===s?void 0:s.status}}};var y=a(2),C={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM504 618H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM312 490v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8z"}}]},name:"file-text",theme:"outlined"},S=a(24),k=function(e,t){return l.createElement(S.a,Object(y.a)({},e,{ref:t,icon:C}))};var w=l.forwardRef(k),M=a(798),N=a(801),D=a(1);const A=e=>{let{open:t,setOpen:a,...s}=e;const c=Object(l.useMemo)((()=>r.a.getHeaders()),[]),[n,o]=Object(l.useState)(1),[i,u]=Object(l.useState)(0),[m,b]=Object(l.useState)([]),j=Object(l.useCallback)((async()=>{const e=await(async(e,t,a)=>{try{const s=await d.a.get("".concat(f,"?archives=true&pageNo=").concat(t-1,"&pageSize=").concat(a),{headers:e});return 200===s.status?{tableData:s.data.map((e=>{var t,a,s;return{id:e.id,cellOne:"".concat(null===(t=e.resourceManager)||void 0===t?void 0:t.firstName," ").concat(null===(a=e.resourceManager)||void 0===a?void 0:a.lastName),cellTwo:"".concat(null===(s=e.resourceManager)||void 0===s?void 0:s.role),cellThree:e.startDate,cellFour:e.endDate,cellFive:e.commissionAmount}})),totalItems:s.headers["total-elements"]}:{tableData:[],totalItems:0}}catch(c){var s;return 401===c.response.status&&r.a.logout(),{statusCode:null===(s=c.response)||void 0===s?void 0:s.status}}})(c,n,10);e&&(b(e.tableData),u(e.totalItems))}),[n,c]);return Object(l.useEffect)((()=>{j()}),[n,c,j,t]),Object(D.jsx)(N.a,{openArchive:t,setOpenArchive:a,loadArchive:j,archive:m,archivedData:"commission",headers:["Resource Manager","Role","Start Date","End Date","Commission Amount"],totalItems:i,setArchiveCurrentPage:o,archiveCurrentPage:n})};var I=a(805),R=a(808);const E=()=>{const[e,t]=Object(l.useState)(!0),a=Object(i.useHistory)(),[u,y]=Object(l.useState)([]),C=Object(l.useMemo)((()=>r.a.getHeaders()),[]),[S,k]=Object(l.useState)([]),[N,E]=Object(l.useState)([]),[z,F]=Object(l.useState)(1),[L,H]=Object(l.useState)(10),[P,V]=Object(l.useState)(0),[B,T]=Object(l.useState)({}),[U,J]=Object(l.useState)(!1),[K,$]=Object(l.useState)(!1),[_,q]=Object(l.useState)({}),[G,Q]=Object(l.useState)([]),[W,X]=Object(l.useState)(!1),[Y,Z]=Object(l.useState)(!0),[ee,te]=Object(l.useState)(!1),[ae,se]=Object(l.useState)([]),ce=Object(j.b)(),ne=Object(l.useCallback)((()=>{ce(Object(O.b)(!1)),r.a.logout()}),[ce]),oe=Object(l.useCallback)((e=>{a.push("/commission/".concat(e))}),[a]),re=Object(l.useCallback)((async()=>{await d.a.get("".concat(b.a.serverURL,"/resourcemanager?dropdown=true"),{headers:C}).then((e=>{e.data&&se(e.data.map((e=>({text:"".concat(e.firstName," (").concat(e.lastName,")"),value:e.resourceManagerId}))))})).catch((e=>console.log(e)))}),[C]);Object(l.useEffect)((()=>re()),[re]);const le=Object(l.useMemo)((()=>[{width:"100px",render:(e,t)=>Object(D.jsx)(M.a,{onClick:()=>oe(t.id),label:Object(D.jsx)("div",{style:{fontSize:"25px",paddingLeft:"25px"},children:Object(D.jsx)(w,{})})})},{title:"Resource Manager",dataIndex:"resourceManager",key:"resourceManager.firstName",sorter:!0,render:e=>Object(D.jsx)(p.a,{name:"".concat(null===e||void 0===e?void 0:e.firstName," ").concat(null===e||void 0===e?void 0:e.lastName)}),filters:ae,filterSearch:!0},{title:"Role",dataIndex:"resourceManager",key:"resourceManager.role",sorter:!0,render:e=>Object(D.jsx)("span",{children:e.role})},{title:"Start Date",dataIndex:"startDate",key:"startDate",sorter:!0},{title:"End Date",dataIndex:"endDate",key:"endDate",sorter:!0},{title:"Commission Amount",dataIndex:"commissionAmount",key:"commissionAmount",align:"center",sorter:!0,render:e=>Object(D.jsx)("div",{style:{textAlign:"right"},children:Object(D.jsxs)("span",{children:["$",Number(e).toFixed(2)]})})}]),[ae,oe,U]);Object(l.useEffect)((()=>{k(le)}),[le]);const ie=Object(l.useCallback)((async()=>{const e="pageNo=".concat(z-1,"&pageSize=-1");if(!Object.keys(B).length){let t="?".concat(e);for(const e in _)e&&(t+="&orderBy=".concat(e,"&orderMode=").concat(_[e]));return await async function(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const a="".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"").concat(t);return await x(e,a)}(C,t)}{const e=Object.keys(_)[0]?Object.keys(_)[0]:"",a=e?_[e]:"",s=await(async(e,t,a,s,c,n)=>{const o=c?"&orderBy=".concat(c,"&orderMode=").concat(n):"",l="pageNo=".concat(t-1,"&pageSize=").concat(a);let i="".concat(f,"?dropdownFilter=true&").concat(l);Object.keys(o).length&&(i+="".concat(o));try{const t=await d.a.put(i,s,{headers:e});if(t)return{statusCode:t.status,data:t.data.length?g(t.data):[],totalItems:t.headers["total-elements"]}}catch(b){var u,m;return console.log(b),401===(null===(u=b.response)||void 0===u?void 0:u.status)&&r.a.logout(),{statusCode:null===(m=b.response)||void 0===m?void 0:m.status}}})(C,z,L,B,e||"id",a||"desc");200===s.statusCode&&(y(s.data),V(s.totalItems),t(!1))}}),[C,z,L,_,B]);Object(l.useEffect)((()=>{let e=!1;return t(!0),ie().then((e=>{200===e.statusCode&&(y(e.tableData),V(e.totalItems))})).catch((t=>{e||console.log(t)})).finally((()=>t(!1))),()=>e=!0}),[ie,B,U]);const ue=Object(l.useCallback)((e=>{T({...B,search:e})}),[B]),de=Object(l.useCallback)((e=>{let t=[];for(let a in e)"string"!==typeof e[a]&&"number"!==typeof e[a]||"id"===a||""===e[a]?"object"===typeof e[a]&&(t=t.concat(de(e[a]))):t.push(e[a]);return t}),[]);Object(l.useEffect)((()=>{if(u){let e=[];for(let t of u){de(t).forEach((t=>{e.includes(t)||e.push(t)}))}Q(e)}}),[u,B,de]);const me={onChange:(e,t)=>{E(W?[]:e)},selectedRowKeys:N},be=e=>{a.push(e)};return Object(D.jsxs)(s.a,{children:[Object(D.jsx)(h.a,{onActive:()=>{Z(!0)},onIdle:()=>{Z(!1)},onLogout:()=>{te(!0)}}),Object(D.jsx)(c.a,{title:"Commission",actions:Object(D.jsxs)(D.Fragment,{children:[Object(D.jsxs)(n.a,{type:"button",className:"btn main margin-left",handleClick:()=>be("/addcommission"),children:[Object(D.jsx)(o.a,{className:"icon"}),"Add Commission"]}),Object(D.jsxs)(n.a,{type:"button",className:"btn main margin-left",handleClick:()=>be("/viewcommissiontype"),children:[Object(D.jsx)(o.a,{className:"icon"}),"view Commission Type"]})]})}),Object(D.jsx)(v.a,{loading:e,data:u.map((e=>({...e,key:e.id}))),columns:S,setColumns:k,defaultColumns:le,rowSelection:W?null:me,total:P,setCurrentPage:F,setPageSize:H,setSort:q,setFilters:T,filters:B,searchOptions:G,searchList:u,handleSearch:ue,openArchive:()=>J(!0),openReports:()=>$(!0),handleConfirmArchive:async()=>{try{if(await d.a.all(N.map((e=>d.a.delete("".concat(b.a.serverURL,"/commission/").concat(e),{headers:C}))))){const e=await ie();e&&(y(e.tableData),V(e.totalItems),m.b.success("commission archived successfully!"),E([]))}}catch(t){var e;m.b.error("Error ".concat(null===(e=t.response)||void 0===e?void 0:e.status)),t.response&&401===t.response.status&&ne()}},handleCancelArchiving:()=>{E([])},removeableColumns:le.filter((e=>"Resource Manager"!==e.title&&e.title)).map((e=>e.title))}),Object(D.jsx)(A,{open:U,setOpen:J}),Object(D.jsx)(I.a,{showReportModal:K,setShowReportModal:$,individualReportName:"commission",individualList:u,list:u.map((e=>({id:e.id,name:"".concat(e.resourceManager.firstName+" "+e.resourceManager.lastName)}))),listLabel:"commission",filename:"commission_report",tableFields:[{label:"Role",value:"role",key:"role"},{label:"Start Date",value:"startDate",key:"startDate"},{label:"End Date",value:"endDate",key:"endDate"},{label:"Commission Amount",value:"commissionAmount",key:"commissionAmount"}],pdfFormatter:R.a.commissionPdfFormat,csvExcelFormatter:R.a.commissionCSVExcel})]})};t.default=E},798:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));a(800);var s=a(1);const c=e=>Object(s.jsxs)("div",{className:"tablelink-container",children:[Object(s.jsx)("span",{onClick:e.onClick,className:"tablelink ".concat(e.styleRed&&"red"," ").concat(e.className&&e.className),children:e.label}),e.extra&&Object(s.jsx)("span",{className:"table-link-extra",children:e.extra})]})},806:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));a(807);var s=a(1);const c=e=>{let{name:t,location:a,...c}=e;return Object(s.jsxs)("div",{className:"client-details-container",children:[Object(s.jsx)("span",{children:t}),Object(s.jsx)("span",{children:a}),c.extra&&Object(s.jsx)("span",{children:c.extra})]})}},807:function(e,t,a){}}]);