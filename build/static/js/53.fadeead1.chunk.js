(this.webpackJsonpreactfrontend=this.webpackJsonpreactfrontend||[]).push([[53],{1076:function(e,t,a){"use strict";a.r(t);var s=a(0),c=a(16),n=a.n(c),r=a(25),l=a(13),o=a(219),d=a(218),i=a(804);const u="".concat(r.a.serverURL,"/calender"),b=["DRAFT"];var h=a(801),j=a(1);const O=Object(s.forwardRef)(((e,t)=>{let{open:a,setOpen:c,...r}=e;const o=Object(s.useMemo)((()=>l.a.getHeaders()),[]),[d,i]=Object(s.useState)(1),[b,O]=Object(s.useState)(0),[g,p]=Object(s.useState)([]),f=Object(s.useCallback)((async()=>{const e=await(async(e,t,a)=>{try{const a=await n.a.get("".concat(u,"?archives=true&pageNo=").concat(t-1,"&pageSize=-1"),{headers:e});if(a)return{data:a.data.length?a.data.map((e=>({id:e.id,cellOne:e.startDate,cellTwo:e.endDate,cellThree:e.calender_status,cellFour:e.noOfWeeks}))):[],totalItems:a.headers["total-elements"]}}catch(s){console.log(s)}})(o,d);e&&(p(e.data),O(e.totalItems))}),[d,o]);return Object(s.useEffect)((()=>{f()}),[d,o,f,a]),Object(s.useImperativeHandle)(t,(()=>({loadArchive(){f()},length:g.length}))),Object(j.jsx)(h.a,{openArchive:a,setOpenArchive:c,loadArchive:f,archive:g,archivedData:"calender",headers:["Start Date","End Date","Status","NoOfWeeks"],totalItems:b,setArchiveCurrentPage:i,archiveCurrentPage:d})}));var g=a(152),p=(a(158),a(28)),f=a(91),D=a(805),m=a(808),S=a(22),v=a(66),y=a(126),w=a(420),x=a(11),k=a.n(x),C=a(215),I=a(27),E=a(985),F=a.n(E);a(983),a(984);var M=e=>{const t=Object(s.useMemo)((()=>l.a.getHeaders()),[]),[a,c]=Object(s.useState)(!0),[o,d]=Object(s.useState)(!1),[i,u]=Object(s.useState)(1),[b,h]=Object(s.useState)(""),[O,p]=Object(s.useState)(""),[f,D]=Object(s.useState)(""),[m,S]=Object(s.useState)(""),[x,E]=Object(s.useState)({startDate:new Date(k()().startOf("isoweek").utc()),endDate:new Date(k()().endOf("week").utc())}),M={calender_status:"",startDate:"",endDate:""},[R,A]=Object(s.useState)(M),L=(e,t)=>{let a=new Date(e+" 00:00"),s=N(e);D(s);let c=(t>1?new Date(a.setDate(a.getDate()+7*t-2)):new Date(a.setDate(a.getDate()+5*t))).toISOString().slice(0,10),n=N(c);S(n),h(c)},N=e=>e.substring(5,7)+"-"+e.substring(8,10)+"-"+e.substring(0,4),W=e=>{var t=new Date(e),a=("0"+(t.getMonth()+1)).slice(-2);return[("0"+t.getDate()).slice(-2),a,t.getFullYear()].join("-")},_=e=>{var t=new Date(e),a=("0"+(t.getMonth()+1)).slice(-2),s=("0"+t.getDate()).slice(-2);return[t.getFullYear(),a,s].join("-")},z=()=>{A(M),e.setOpen(!1)};return Object(j.jsxs)(y.a,{header:{text:"Add Calender"},open:e.open,close:()=>{z(),e.setOpen(!1)},children:[Object(j.jsx)(g.a,{onActive:()=>{c(!0)},onIdle:()=>{c(!1)},onLogout:()=>{d(!0)}}),Object(j.jsxs)(v.a,{formEnabled:!0,onSubmit:a=>{a.preventDefault();N(b);if(console.log(f),console.log(m),""===f){let a=new Date,s=a.getDate()-a.getDay()+1;s=new Date(a.setDate(s)).toISOString().slice(0,10);let c=a.getDate()-a.getDay()+5;return c=new Date(a.setDate(c)).toISOString().slice(0,10),s=N(s),c=N(c),void n()({url:"".concat(r.a.serverURL,"/calender/generate?noOfWeeks=").concat(i),data:{endDate:c,startDate:s,noOfWeeks:i},method:"post",headers:t}).then((t=>{console.log("hello"),z(),e.refresh(),w.b.success("Week added successfully")})).catch((e=>{console.log(e),w.b.error("Error when trying to add week")}))}console.log(f),1===new Date(f).getDay()&&(console.log(f),i>1?n()({url:"".concat(r.a.serverURL,"/calender/generate?noOfWeeks=").concat(i),data:{endDate:m,startDate:f,noOfWeeks:i},method:"post",headers:t}).then((t=>{z(),e.refresh(),w.b.success("Week added successfully")})).catch((e=>{console.log(e),w.b.error("Error when trying to add week")})):(n()({url:"".concat(r.a.serverURL,"/calender/generate?noOfWeeks=").concat(i),data:{endDate:m,startDate:f},method:"post",headers:t}).then((t=>{console.log(t),z(),w.b.success("Week added successfully"),e.refresh()})).catch((e=>{console.log(e),w.b.error("Error when trying to add week")})),z()))},cancel:z,children:[Object(j.jsx)("div",{className:"picker",children:Object(j.jsx)("label",{children:"Start Date"})}),Object(j.jsx)("div",{style:{width:"1000px"},children:Object(j.jsx)(F.a,{selected:f?new Date(f):null,onChange:e=>{E({...x,startDate:e}),console.log(e),p(e),D(W(e)),""!==e&&L(_(e),1)},name:"startDate",className:"red-border",filterDate:e=>1===e.getDay(),placeholderText:"dd-MM-yyyy",minDate:new Date((new Date).setDate((new Date).getDate()-(new Date).getDay())),dateFormat:"dd-MM-yyyy"})}),Object(j.jsx)("div",{style:{position:"relative",left:"208px",top:"-41px",width:"611px"},children:Object(j.jsx)(I.a,{label:"End Date",type:"date",name:"endDate",value:m,disabled:!0})}),Object(j.jsx)("div",{style:{width:"611px"},children:Object(j.jsx)(C.a,{id:"weeks",name:"weeks",placeholder:"Generate Weeks...",onChange:e=>{""!==f&&(L(_(f),e),u(e))},options:[{value:2,label:"2"},{value:3,label:"3"},{value:4,label:"4"},{value:5,label:"5"}]})})]})]},z?"reset":"no-reset")},R=a(762);t.default=e=>{const t=Object(p.b)(),a=Object(s.useMemo)((()=>l.a.getHeaders()),[]),c=Object(s.useRef)(null),[h,v]=Object(s.useState)([]),[y,x]=Object(s.useState)(0),[k,C]=Object(s.useState)(10),[I,E]=Object(s.useState)(1),[F,A]=Object(s.useState)(!1),[L,N]=Object(s.useState)({}),[W,_]=Object(s.useState)({}),[z,P]=Object(s.useState)(!1),[U,H]=Object(s.useState)([]),[T,B]=Object(s.useState)(!1),[J,Y]=Object(s.useState)([]),[G,K]=Object(s.useState)([]),[V,q]=Object(s.useState)(!0),[Q,X]=Object(s.useState)(!1),[Z,$]=Object(s.useState)(!1),[ee,te]=Object(s.useState)(!1),ae=Object(s.useMemo)((()=>l.a.getUserInfo()),[]),[se,ce]=Object(s.useState)(ae.roles[0]),[ne,re]=Object(s.useState)(!1),le=Object(s.useCallback)((()=>{l.a.logout(),t(Object(f.b)(!1))}),[t]);Object(s.useEffect)((()=>{l.a.hasAdminRole()&&re(!0)}),[]);const oe=Object(s.useMemo)((()=>[{title:"Start Date",dataIndex:"startDate",key:"startDate",fixed:"left",width:170},{title:"End Date",dataIndex:"endDate",key:"endDate",fixed:"left",width:170},{title:"Status",dataIndex:"calender_status",key:"calender_status",width:170,render:e=>Object(j.jsx)("span",{className:"table-record-status ".concat(e&&e.toLowerCase()),children:e})}]),[L]),de=Object(s.useMemo)((()=>[{title:"Start Date",dataIndex:"startDate",key:"startDate",fixed:"left",width:170,sorter:!0},{title:"End Date",dataIndex:"endDate",key:"endDate",fixed:"left",width:170,sorter:!0},{title:"Status",dataIndex:"calender_status",key:"calender_status",width:170,filters:b.map((e=>({text:e,value:e}))),sorter:!0,render:e=>Object(j.jsx)("span",{className:"table-record-status ".concat(e&&e.toLowerCase()),children:e})}]),[L]);Object(s.useEffect)((()=>{Y(ee?de:oe)}),[ee,oe]);const ie=Object(s.useCallback)((async()=>{let e="";for(const a in W)a&&(e+="&orderBy=".concat(a,"&orderMode=").concat(W[a],"&isFuture=").concat(ee));const t=Object.keys(L).length?L:null;B(!0);const s=await async function(e,t,a){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;try{const r=s||c?s?"?dropdownFilter=true&pageNo=".concat(t-1,"&pageSize=").concat(a,"&").concat(s):"?dropdownFilter=true&pageNo=".concat(t-1,"&pageSize=").concat(a):"?pageNo=".concat(t-1,"&pageSize=-1"),l=c?await n.a.put("".concat(u).concat(r),c,{headers:e}):await n.a.get("".concat(u).concat(r),{headers:e});if(200===l.status)return{data:l.data.map((e=>({...e}))),totalItems:l.headers["total-elements"],status:l.status}}catch(d){var r,o;return 401===(null===(r=d.response)||void 0===r?void 0:r.status)&&l.a.logout(),{status:null===(o=d.response)||void 0===o?void 0:o.status}}}(a,I,k,e,t);s&&B(!1),200===s.status&&(v(s.data),x(s.totalItems)),200!==s.status&&w.b.error("Something's gone wrong, refresh page or contact your system admin")}),[L,I,k,a,W]),ue=Object(s.useCallback)((async e=>{await n.a.get("".concat(r.a.serverURL,"/calender/future?pageNo=").concat(I-1,"&pageSize=-1"),{headers:a}).then((t=>{let a=parseInt(t.headers["total-items"]),s=t.data;0===s.length&&I>1&&E(I-1),x(a),v(s),e(s)})).catch((e=>{console.log(e)}))}),[a,I]);Object(s.useEffect)((()=>{ee&&0===Object.keys(W).length&&0===Object.keys(L).length?ue():ie()}),[ie,F]);const be=Object(s.useCallback)((e=>{let t=[];for(let a in e)if("string"!==typeof e[a]&&"number"!==typeof e[a]||"id"===a||""===e[a])"object"===typeof e[a]&&"candidate"!==a&&"resume"!==a&&(t=t.concat(be(e[a])));else if("ca"===a){let s=e[a].split(" ");t.push(s[0],s[1],s[2])}else t.push(e[a]);return t}),[]);Object(s.useEffect)((()=>{if(h){let e=[];for(let t of h){be(t).forEach((t=>{e.includes(t)||e.push(t)}))}H(e)}}),[h,L,be]);const he={onChange:e=>{K(e)},selectedRowKeys:G},je=Object(s.useCallback)((e=>{N({...L,search:e})}),[L]);return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)(o.a,{children:[Object(j.jsx)(d.a,{title:"Calender",actions:Object(j.jsxs)(j.Fragment,{children:[ne||se.calendarPermission?Object(j.jsxs)(S.a,{type:"button",className:"btn main",handleClick:()=>$(!0),children:[Object(j.jsx)(R.a,{className:"icon"}),"Add Calender"]}):"",Object(j.jsx)("div",{style:{fontSize:"15px",position:"relative",marginBottom:"-3",left:"15px",color:"black"},children:Object(j.jsx)("input",{type:"checkbox",onClick:e=>{let t=e.target.checked;te(t),_({}),N({}),t?ue():ie()}})}),Object(j.jsx)("label",{style:{fontSize:"15px",position:"relative",marginBottom:"2",left:"20px",color:"var(--secondary)"},children:"Show Feature Week"})]})}),Object(j.jsx)(g.a,{onActive:()=>{q(!0)},onIdle:()=>{q(!1)},onLogout:()=>{X(!0)}}),Object(j.jsx)(i.a,{loading:T,data:h.map((e=>({...e,key:e.id}))),columns:J,setColumns:Y,defaultColumns:oe,rowSelection:!(!ne&&!se.calendarPermission)&&he,total:y,setCurrentPage:E,setPageSize:C,setSort:_,setFilters:N,filters:L,searchOptions:U,searchList:h,handleSearch:je,openArchive:()=>A(!0),openReports:()=>P(!0),handleConfirmArchive:()=>{n.a.all(G.map((e=>n.a.delete("".concat(r.a.serverURL,"/calender/").concat(e),{headers:a})))).then((e=>{v([]),K([]),ee?ue():ie()})).catch((e=>{console.log(e),e.response&&401===e.response.status&&le()}))},handleCancelArchiving:()=>{K([])},removeableColumns:oe.filter((e=>"calender"!==e.title&&e.title)).map((e=>e.title))}),Object(j.jsx)(O,{open:F,setOpen:A,ref:c})]}),Object(j.jsx)(D.a,{showReportModal:z,setShowReportModal:P,individualReportName:"calender",individualList:h,list:h.map((e=>({id:e.id,name:e.calender_status}))),listLabel:"Calender",filename:"calender_report",tableFields:[{label:"Start Date",value:"startDate",key:"startDate"},{label:"EndDate",value:"endDate",key:"endDate"},{label:"Status",value:"calender_status",key:"calender_status"}],pdfFormatter:m.a.calenderPdfFormat,csvExcelFormatter:m.a.calenderCSVExcel}),Object(j.jsx)(M,{open:Z,setOpen:$,refresh:()=>{let e=!1;return B(!0),ie().then((e=>{200===e.statusCode&&(v(e.tableData),x(e.totalItems))})).catch((t=>{e||console.log(t)})).finally((()=>B(!1))),()=>e=!0}})]})}},984:function(e,t,a){}}]);